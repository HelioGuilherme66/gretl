tooldir = ../tools

CC = @CC@
CFLAGS = @CFLAGS@
have_gtk = @have_gtk@
GMP_LIBS = @GMP_LIBS@
FLIB = @FLIB@

ifeq ($(CC),)
  CC = gcc
endif

LIBGRETL = ../lib/libgretl-1.0.la
RAND_LIBS = $(LIBGRETL)

ifeq ($(GMP_LIBS),)
  DEFINES = -DNO_GMP
else
  DEFINES = -DUSE_GMP
endif

ifeq ($(havegtk),2.0)
  RAND_LIBS += $(GLIB_LIBS)
endif

override CFLAGS += -I../lib/src $(DEFINES)

all: nistcheck

nistcheck: nistcheck.o
	../libtool --mode=link $(CC) -o $@ $< $(LIBGRETL)

randcheck: diehard mtrand
	./mtrand && ./diehard

diehard: diehard.c
	$(CC) -o $@ $< $(FLIB) -lm

mtrand: mtrand.o
	../libtool --mode=link $(CC) -o $@ $< $(RAND_LIBS)

.PHONY :

check: nistcheck
	./nistcheck

clean:
	rm -f nistcheck diehard mtrand *.o test.out
	rm -f gretl.32 gretl_rand.txt
	rm -rf .libs

depend:
	makedepend -Y../lib/src *.c 

distdepend: depend
	$(tooldir)/dist_depend.pl

# DO NOT DELETE

nistcheck.o: ../lib/src/libgretl.h ../lib/src/commands.h ../lib/src/errors.h
nistcheck.o: ../lib/src/estimate.h ../lib/src/generate.h
nistcheck.o: ../lib/src/gretl_utils.h ../lib/src/compare.h
nistcheck.o: ../lib/src/pvalues.h ../lib/src/dataio.h ../lib/src/strutils.h
nistcheck.o: ../lib/src/describe.h ../lib/src/printout.h
nistcheck.o: ../lib/src/modelprint.h ../lib/src/texprint.h ../lib/src/var.h
nistcheck.o: ../lib/src/interact.h ../lib/src/graphing.h ../lib/src/random.h
nistcheck.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
nistcheck.o: ../lib/src/discrete.h ../lib/src/subsample.h
nistcheck.o: ../lib/src/calendar.h ../lib/src/system.h
