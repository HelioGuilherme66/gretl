\chapter{Dati panel}
\label{chap-panel}

\section{Stima di modelli panel}

\subsection{Minimi quadrati ordinari}
\label{pooled-est}

Lo stimatore più semplice per i dati panel è quello ``pooled OLS'' (ossia i
minimi quadrati ordinari utilizzando allo stesso modo tutte le osservazioni del
campione). In genere questo stimatore non fornisce risultati ottimali, ma
rappresenta un metro di paragone per stimatori più complessi.

Quando si stima un modello usando i minimi quadrati ordinari (OLS) su dati
panel, è disponibile un tipo di test aggiuntivo: nel menù \textsf{Test} della
finestra del modello è il comando ``Diagnosi panel'', mentre nella versione a
riga di comando del programma è il comando \cmd{hausman}.

Per eseguire questo test, occorre specificare un modello senza alcuna variabile
dummy relativa alle unità cross-section. Il test confronta il semplice modello
OLS con le due principali alternative: il modello a effetti fissi e quello a
effetti casuali.

Il modello a \emph{effetti fissi} sopprime la costante e aggiunge una variabile
dummy per tutte le unità cross section, permettendo così all'intercetta della
regressione di variare per ogni unità.  Viene eseguito un test \emph{F} per
testare l'ipotesi nulla che l'intercetta sia uguale per tutte le
unità: un basso p-value per questo test depone contro l'ipotesi nulla e a favore
dell'adeguatezza del modello a effetti fissi.

Il modello a \emph{effetti casuali}, d'altra parte, scompone la varianza dei
residui in due parti: una specifica all'unità cross section, o
``gruppo'', e una specifica all'osservazione particolare (la stima può
essere eseguita solo se il panel è abbastanza ``largo'', ossia se il
numero delle unità cross section nel dataset è maggiore del numero dei
parametri da stimare).  La statistica LM di Breusch--Pagan testa
l'ipotesi nulla che il modello pooled OLS sia adeguato, rispetto all'alternativo
modello a effetti casuali.

Può accadere che il modello pooled OLS sia rifiutato nei confronti di
entrambe le alternative, a effetti fissi o casuali. Come giudicare
quindi l'adeguatezza relativa dei due metodi alternativi di stima? Il
test di Hausman (i cui risultati sono mostrati a patto che il modello
a effetti casuali possa essere stimato) cerca di risolvere questo
problema.  A patto che gli errori specifici di unità o di gruppo siano
non correlati con le variabili indipendenti, lo stimatore a effetti
casuali è più efficiente dello stimatore a effetti fissi; nel caso
contrario lo stimatore a effetti casuali non è consistente e deve
essergli preferito lo stimatore a effetti fissi.  L'ipotesi nulla per
il test di Hausman è che l'errore specifico di gruppo non sia
correlato con le variabili indipendenti (e quindi che il modello a
effetti casuali sia preferibile). Un basso p-value per questo test
suggerisce di rifiutare il modello a effetti casuali in favore del
modello a effetti fissi.  

Per una discussione rigorosa di questo argomento, si veda il capitolo
14 di Greene (2000).
 
\section{I modelli a effetti fissi e casuali}
\label{panel-est}

La specificazione ``pooled OLS'' si può scrivere come
\[
y_{it} = X_{it}\beta + u_{it}
\]
dove $y_{it}$ è l'osservazione della variabile dipendente per l'unità cross
section $i$ nel periodo $t$, $X_{it}$ è un vettore $1\times k$ di variabili
indipendenti osservate per l'unità $i$ nel periodo $t$,
$\beta$ è un vettore $k\times 1$ di parametri, e $u_{it}$ è un termine di errore
o di disturbo specifico all'unità $i$ nel periodo $t$.

I modelli a effetti fissi e casuali rappresentano due modi di scomporre l'errore
unitario $u_{it}$.  Per il modello a effetti fissi possiamo scrivere
\[
u_{it} = \alpha_i + \varepsilon_{it}
\]
Ossia, scomponiamo $u_{it}$ in una componente specifica all'unità e invariante
nel tempo, $\alpha_i$, e un errore specifico all'osservazione,
$\varepsilon_{it}$.  Gli $\alpha_i$ sono quindi trattati come parametri fissi
(intercette $y$ specifiche per le unità) da stimare. Questo può essere fatto
includendo una variabile dummy per ogni unità cross section (e sopprimendo la
costante comune), oppure è possibile procedere sottraendo le medie di gruppo da
ognuna delle variabili e stimando un modello senza costante. Nell'ultimo caso la
variabile dipendente si può scrivere come
\[
\tilde{y}_{it} = y_{it} - \frac{1}{T_i} \sum_{t=1}^{T_i} y_{it}
\]
dove $T_i$ è il numero di osservazioni per l'unità $i$; in modo simile si
possono riscrivere le variabili indipendenti. È possibile ottenere stime degli
$\alpha_i$ usando
\[
\hat{\alpha}_i = \frac{1}{T_i} \sum_{t=1}^{T_i} 
   \left(y_{it} - X_{it}\hat{\beta}\right)
\]

Questi due metodi sono numericamente equivalenti, e \app{gretl} sceglie tra i
due a seconda del numero di unità cross section e di variabili indipendenti
(cercando di minimizzare l'uso delle memoria).

Per il modello a effetti casuali possiamo scrivere
\[
u_{it} = v_i + \varepsilon_{it}
\]
Invece di trattare gli $v_i$ come parametri fissi, li trattiamo come estrazioni
casuali da una certa distribuzione di probabilità. Per stimare questo modello
occorre per prima cosa fare un inferenza a proposito delle rispettive varianze
di $v_i$ e $\varepsilon_{it}$. La varianza di $v_i$, $\sigma^2_v$, è di solito
chiamata la varianza ``between'' (esterna, visto che si riferisce alla
variazione tra le unità cross section), mentre $\sigma^2_{\varepsilon}$ è
chiamata varianza ``within'' (interna).

\section{Esempio: la Penn World Table}
\label{PWT}

La Penn World Table (homepage a
\href{http://pwt.econ.upenn.edu/}{pwt.econ.upenn.edu}) è un ricco
dataset panel macroeconomico, che comprende 152 paesi sull'arco
temporale 1950--1992. I dati sono disponibili in formato \app{gretl}:
si veda la
\href{http://gretl.sourceforge.net/gretl_data_it.html}{pagina dei
  dati} di \app{gretl} (i dati sono liberamente scaricabili, anche se
non sono distribuiti nel pacchetto principale di
\app{gretl}).

L'esempio \ref{examp-pwt} apre il file
\verb+pwt56_60_89.gdt+, un sottoinsieme della Penn World Table che
contiene dati per 120 paesi negli anni 1960--89, su 20 variabili,
senza osservazioni mancanti (il dataset completo, anch'esso compreso
nel pacchetto pwt per \app{gretl}, contiene molte osservazioni
mancanti). Viene calcolata la crescita del PIL reale sul periodo
1960--89 per ogni paese, e viene regredita sul livello del PIL reale
dell'anno 1960, per analizzare l'ipotesi della ``convergenza'' (ossia
di una crescita più veloce da parte dei paesi che partono da una
situazione peggiore).

\begin{script}[htbp]
  \caption{Uso della Penn World Table}
  \label{examp-pwt}

\begin{code}
          open pwt56_60_89.gdt 
          # Per l'anno 1989 (l'ultima oss.) il ritardo 29 dà 1960, la prima oss. 
          genr gdp60 = RGDPL(-29) 
          # Calcola la crescita totale del PIL reale sui 30 anni
          genr gdpgro = (RGDPL - gdp60)/gdp60
          # Restringi il campione a una cross-section del 1989
          smpl --restrict YEAR=1989 
          # convergenza: i paesi che partono più indietro crescono di più?
          ols gdpgro const gdp60 
          # risultato: no! Proviamo una relazione inversa?
          genr gdp60inv = 1/gdp60 
          ols gdpgro const gdp60inv 
          # Ancora no. Proviamo a trattare l'Africa in modo speciale? 
          genr afdum = (CCODE = 1)
          genr afslope = afdum * gdp60 
          ols gdpgro const afdum gdp60 afslope 
\end{code}

\end{script}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "gretl-guide-it"
%%% End: 

