\chapter{Dettagli sui file di dati}
\label{app-datafile}


\section{Formato interno di base}
\label{native}

Nel formato dati interno di \app{Gretl} un dataset è immagazzinato in
XML (extensible mark-up language).  I file di dati sono conformi al
semplice DTD (document type definition) contenuto nel file
\verb+gretldata.dtd+, fornito con la distribuzione di \app{Gretl} e
installato nella directory dei dati di sistema (ad es.
\verb+/usr/share/gretl/data+ su Linux). I file di dati possono essere
non compressi o compressi con gzip; oltre ai valori dei dati,
contengono altre informazioni aggiuntive, come i nomi e le descrizioni
delle variabili, la frequenza dei dati e così via.

La maggior parte degli utenti probabilmente non avrà bisogno di
leggere o scrivere questi file, se non usando \app{Gretl} stesso, ma
se si vuole manipolarli usando altri strumenti, può essere utile
esaminare il DTD e qualcuno dei file di esempio forniti: il file
\verb+data4-1.gdt+ dà un semplice esempio, il file \verb+data4-10.gdt+
invece contiene anche delle etichette per le osservazioni.

\section{Formato tradizionale di ESL}
\label{traddata}

Per compatibilità all'indietro, \app{Gretl} può elaborare anche file
di dati nel formato ``tradizionale'' ereditato dal programma \app{ESL}
di Ramanathan.  In questo formato (che era quello predefinito nelle
versioni di \app{Gretl} precedenti alla 0.98) un dataset è
rappresentato da due file: uno contiene i dati veri e propri, l'altro
contiene la descrizione dei dati e le modalità per la loro lettura.
Per essere più specifici:

\begin{enumerate}
\item \emph{Dati veri e propri}: una matrice rettangolare di numeri
  separati da spazio vuoto. Ogni colonna rappresenta una variabile,
  ogni riga un'osservazione per ognuna delle variabili (come in un
  foglio elettronico). Le colonne dei dati possono essere separate da
  spazi o caratteri tab. Il nome del file deve avere l'estensione
  \verb+.gdt+ e il file di solito è di tipo ASCII (testo semplice), ma
  può essere anche compresso con gzip, per occupare meno spazio su
  disco. È possibile inserire commenti in un file di dati: se una riga
  comincia con un carattere cancelletto (\verb+#+), l'intera riga
  viene ignorata (questo comportamento è coerente con i file di dati
  di gnuplot e di octave).
\item \emph{Descrizione}: il file di dati deve essere accompagnato da
  un file di descrizioni, che ha lo stesso nome di base del file di
  dati, ma l'estensione \verb+.hdr+.  Questo file contiene,
  nell'ordine:

  \begin{itemize}
  \item (Opzionale) \emph{commenti} sui dati, introdotti dalla stringa
    di apertura \verb+(*+ e conclusi dalla stringa \verb+*)+; ognuna
    di queste stringhe deve essere presente da sola su una riga.
  \item (Richiesta) lista dei \emph{nomi delle variabili} presenti nel
    file, separati da spazio bianco. I nomi sono limitati a 8
    caratteri, devono iniziare con una lettera e possono contenere
    solo caratteri alfanumerici e il carattere trattino basso,
    \verb+_+. La lista può continuare su più righe e deve essere
    chiusa da un punto e virgola \verb+;+.
  \item (Richiesta) riga \emph{osservazioni}, nel formato 
    \verb+1 1 85+. Il primo elemento indica la frequenza dei dati (1 per dati
    non datati o annuali, 4 per trimestrali, 12 per mensili).  Gli
    altri due elementi indicano le osservazioni iniziale e finale: di
    solito questi saranno pari a 1 e al numero delle osservazioni, per
    i dati non datati. Per le serie storiche, è possibile usare date
    nella forma \cmd{1959.1} (trimestrale, una cifra dopo il punto) o
    \cmd{1967.03} (mensile, due cifre dopo il punto). Si veda il
    capitolo~\ref{chap-panel} per l'uso speciale di questa riga nel
    caso dei dati panel.
  \item La parola chiave \verb+BYOBS+.
  \end{itemize}
\end{enumerate}

Ecco un esempio di un file di descrizione dei dati ben scritto.
        
\begin{code}
    (* 
      DATA9-6: 
      Dati su log(moneta), log(reddito) e tasso di interesse USA. 
      Fonte: Stock and Watson (1993) Econometrica 
      (dati grezzi) Il periodo è 1900-1989 (dati annuali). 
      Dati composti da Graham Elliott. 
    *) 
    lmoneta lreddito tassint ; 
    1 1900 1989 BYOBS
\end{code}
          
Il corrispondente file di dati contiene tre colonne di dati, ognuna
con 90 osservazioni.  Ci sono altre tre caratteristiche del formato
dati ``tradizionale'' degne di nota.
    
\begin{enumerate}
\item Se la parola chiave \verb+BYOBS+ è sostituita da \verb+BYVAR+ ed
  è seguita dalla parola chiave \verb+BINARY+, significa che il
  corrispondente file di dati è in formato binario. Questo tipo di
  file di dati può essere scritto da \app{gretlcli} usando il comando
  \cmd{store} con l'opzione \cmd{-s} (precisione singola) o l'opzione
  \cmd{-o} (precisione doppia).
\item Se \verb+BYOBS+ è seguita dalla parola chiave \verb+MARKERS+,
  \app{Gretl} si aspetta un file di dati in cui la \emph{prima
    colonna} contiene stringhe (lunghe al massimo 8 caratteri) usate
  per identificare le osservazioni. Queste possono essere utili nel
  caso dei dati di tipo cross-section in cui le unità di osservazione
  sono identificabili: regioni, stati, città ecc. Un altro caso è
  quello delle serie storiche irregolari, come ad esempio i dati
  giornalieri delle quotazioni azionarie, in cui mancano i giorni in
  cui non avvengono contrattazioni: in questo caso, le osservazioni
  possono essere marcate con una stringa che rappresenta la data, come
  ad esempio \cmd{10/01/98} (si ricordi il limite di 8 caratteri). Si
  noti che le opzioni \cmd{BINARY} e \cmd{MARKERS} sono mutualmente
  esclusive, e si noti anche che i ``marcatori'' non sono considerati
  come una variabile: questa colonna non compare nell'elenco delle
  variabili nel file di descrizione dei dati.
\item Se esiste un file con lo stesso nome di base del file di dati e
  di quello delle descrizioni, ma con l'estensione \verb+.lbl+, esso
  viene letto e usato per riempire le etichette descrittive per le
  serie di dati. Il formato del file di etichette è semplice: ogni
  riga contiene il nome di una variabile (indicata nel file di
  descrizione) seguito da uno o più spazi, seguito dall'etichetta
  descrittiva. Ecco un esempio:

\begin{code}
  prezzo Indice dei prezzi delle auto nuove, anno base 1982
\end{code}
        
\end{enumerate}

Se si vuole salvare i dati nel formato tradizionale, occorre usare
l'opzione \cmd{-t} con il comando \cmd{store}, nella versione a riga
di comando del programma o nella finestra del terminale della versione
grafica del programma.

\section{Dettagli sui database binari}
\label{dbdetails}

Un database di \app{Gretl} consiste di due parti: un file indice ASCII
(con l'estensione \verb+.idx+) che contiene informazioni sulle serie,
e un file binario (con estensione \verb+.bin+) che contiene i dati
veri e propri. Ecco due esempi di voci contenute in un file
\verb+idx+:

\begin{code}
      G0M910  Indice composto da 11 indicatori principali (1987=100) 
      M 1948.01 - 1995.11  n = 575
      currbal Bilancia dei pagamenti: parte corrente; corretta per la stagionalità
      Q 1960.1 - 1999.4 n = 160
\end{code}

Il primo campo è il nome della serie, il secondo è una descrizione
della serie (al massimo di 128 caratteri). Sulla seconda riga, il
primo campo è un codice di frequenza: \verb+M+ per mensile, \verb+Q+
per trimestrale, \verb+A+ per annuale, \verb+B+ per
giornalieri-lavorativi (giornalieri con cinque giorni a settimana) e
\verb+D+ per giornalieri (sette giorni a settimana). Al momento non
vengono accettati altri codici di frequenza. Quindi segue la data
iniziale (con due cifre che seguono il punto nei dati mensili, una per
i dati trimestrali, nessuna per quelli annuali), uno spazio, un
trattino, un altro spazio, la data finale, la stringa ``\verb+n = +''
e il numero delle osservazioni. Nel caso di dati giornalieri, le date
iniziale e finale devono essere indicate nella forma
\verb+YYYY/MM/DD+. Questo formato deve essere rispettato alla
lettera.

Opzionalmente, la prima riga del file indice può contenere un breve
commento (al massimo 64 caratteri) a proposito della fonte e del tipo
dei dati, che segue un carattere cancelletto. Ad esempio:
      
\begin{code}
      # Banca Centrale Europea (tassi di interesse)
\end{code}

Il corrispondente database binario contiene i valori dei dati,
rappresentati come ``float'', ossia come numeri in virgola mobile a
precisione singola, che tipicamente occupano quattro byte ciascuno. I
numeri sono immagazzinati ``per variabile'', così che i primi \emph{n}
numeri sono le osservazioni della variabile 1, i successivi \emph{m}
sono le osservazioni per la variabile 2 e così via.

\chapter{Note tecniche}
\label{app-technote}


\app{Gretl} è scritto nel linguaggio di programmazione C, aderendo
nel modo più stretto possibile allo standard C ISO/ANSI (C90), anche
se l'interfaccia grafica e alcune altre componenti devono fare uso
necessariamente di estensioni specifiche per certe piattaforme.
  
Il programma è stato sviluppato sotto Linux.  La libreria condivisa e
il client a riga di comando dovrebbero essere compilabili su qualsiasi
piattaforma che (a) supporti l'ISO/ANSI C e (b) abbia installate le
seguenti librerie: zlib (per la compressione dei dati), libxml
(manipolazione dell'XML) e LAPACK (supporto per l'algebra lineare). La
home page di zlib si trova a
\href{http://www.info-zip.org/pub/infozip/zlib/}{info-zip.org}, libxml
si trova a \href{http:/xmlsoft.org/}{xmlsoft.org}, mentre LAPACK è a
\href{http://www.netlib.org/lapack/}{netlib.org}.  Se il sistema
ospita anche la libreria GNU readline, essa sarà usata per
\app{gretcli}, fornendo una riga di comando molto più comoda da
utilizzare. Si veda la
\href{http://cnswww.cns.cwru.edu/~chet/readline/rltop.html}{home page
  di readline}.  

Il client grafico dovrebbe essere compilabile e utilizzabile su ogni
sistema che, oltre ai requisiti visti sopra, offra la libreria GTK
nella versione 1.2.3 o superiore (si veda
\href{http://www.gtk.org/}{gtk.org}). Al momento della scrittura di
questo manuale esistono due varianti principali delle librerie GTK: la
serie 1,2 e la serie 2.0, lanciata nell'estate 2002.  Poiché queste
varianti sono mutualmente incompatibili, \app{Gretl} può essere
compilato usando una sola di esse; il pacchetto sorgente contiene due
directory: \verb+gui+ per GTK 1.2 e \verb+gui2+ per GTK 2.0.
Raccomando l'uso di GTK 2.0 se è disponibile, visto che offre molti
vantaggi rispetto a GTK 1.2.
  
\app{Gretl} chiama gnuplot per produrre grafici. È possibile trovare
gnuplot a \href{http://www.gnuplot.info/}{gnuplot.info}. Al momento
della scrittura di questo manuale, la versione ufficiale più recente
di gnuplot è la 4.0 (dell'Aprile 2004).  La versione MS Windows di
\app{Gretl} comprende la versione 4.0 di gnuplot per Windows; sul sito
web di Gretl è possibile trovare un pacchetto rpm di gnuplot 3.8j0 per
sistemi Linux x86.
  
Alcune funzionalità di \app{Gretl} fanno uso della libreria
\app{gtkextra} di Adrian Feguin. È possibile trovare gtkextra a
\href{http://gtkextra.sourceforge.net/}{gtkextra.sourceforge.net}.  Le
parti rilevanti di questo pacchetto sono incluse (in forma leggermente
modificata) con la distribuzione sorgente di \app{Gretl}.
  
Una versione binaria del programma è disponibile per la piattaforma
Microsoft Windows (versione 32-bit, ossia Windows 95 o superiore).
Questa versione è cross-compilata su Linux usando mingw (il
compilatore GNU C, \app{gcc}, portato per l'uso con win32) e collegata
alla libreria C di Microsoft C, \verb+msvcrt.dll+. Utilizza il port di
GTK 2.0 su win32 di Tor Lillqvist. L'installatore per Windows (libero,
open-source) è a cura di Jordan Russell
(\href{http://www.jrsoftware.org/}{jrsoftware.org}).  

Speriamo che gli utenti con conoscenze di programmazione possano
considerare \app{Gretl} abbastanza interessante e degno di essere
migliorato ed esteso. La documentazione dell'API libgretl non è ancora
completa, ma è possibile trovare alcuni dettagli seguendo il link
``Libgretl API docs'' sul sito web di \app{Gretl}.

\chapter{Accuratezza numerica}
\label{app-accuracy}

\app{Gretl} usa aritmetica a doppia precisione, ad eccezione del
plugin per precisione multipla invocabile con il comando del menù
``Modello, Minimi quadrati in alta precisione'' che rappresenta i
valori in virgola mobile usando un numero di bit indicato dalla
variabile di ambiente \verb+GRETL_MP_BITS+ (valore predefinito: 256).
Le equazioni normali dei minimi quadrati sono risolte in modo
predefinito usando la decomposizione di Cholesky, che è abbastanza
accurata per la maggior parte delle applicazioni (c'è anche l'opzione
di usare la decomposizione QR). Il programma è stato testato
abbastanza approfonditamente con i dataset di riferimento forniti dal
NIST (il National Institute of Standards and Technology statunitense)
e un rapporto completo dei risultati si trova sul sito web di Gretl
(seguendo il link ``Accuratezza numerica'').

Giovanni Baiocchi e Walter Distaso hanno pubblicato una recensione di
\app{Gretl} per il \emph{Journal of Applied Econometrics} (2003).  Siamo grati a
Baiocchi e Distaso per il loro accurato esame del programma, che ha suggerito le
seguenti modifiche.

\begin{enumerate}
\item I recensori hanno trovato un bug nel ``calcolatore di p-value''
  di \app{Gretl}, perché il programma mostrava il complemento della
  probabilità corretta per i valori negativi di \emph{z}. Il bug è
  stato corretto nella versione 0.998 del programma (pubblicata il 9
  Luglio 2002).
\item È stato anche notato che il calcolatore di p-value produceva
  risultati non accurati per valori estremi di \emph{x} (ad es. valori
  da 8 a 10 nella distribuzione \emph{t} con 100 gradi di libertà).
  Anche questo problema è stato risolto nella versione 0.998 di
  \app{Gretl}, inserendo codice più accurato per la distribuzione di
  probabilità.
\item I recensori hanno notato un difetto nella presentazione dei
  coefficienti di regressione in \app{Gretl}, perché alcuni
  coefficienti venivano mostrati con un numero troppo basso di cifre
  significative. Il difetto è stato corretto nella versione 0.999
  (pubblicata il 25 Agosto 2002): ora tutte le statistiche associate
  con la regressione sono mostrate con 6 cifre significative.
\item I test eseguiti dai recensori indicavano che l'accuratezza
  numerica di \app{Gretl} su MS Windows era minore che su Linux.
  Ad esempio, i dati Longley (un dataset notoriamente ``mal-condizionato'' usato
  spesso per testare i programmi econometrici) la versione Windows di Gretl
  produceva alcuni coefficienti con la settima cifra errata, mentre gli stessi
  coefficienti risultavano corretti su Linux. Questa anomalia è stata corretta
  nella versione 1.0pre3 di \app{Gretl} (pubblicata il 10 Ottobre 2002).
\end{enumerate}

La versione attuale di \app{Gretl} comprende un ``plugin'' che esegue
la suite NIST di test della regressione lineare. È possibile trovarlo
nel menù ``Utilità'' della finestra principale. Quando viene eseguito
questo test, un'introduzione spiega qual è il risultato atteso: se si
esegue il test e si ottengono risultati diversi da quelli attesi, si
prega di inviare un bug report a \verb+cottrell@wfu.edu+.  

Come detto sopra, tutte le statistiche di regressione sono mostrate
con 6 cifre significative nella versione attuale di \app{Gretl}
(tranne quando viene usato il plugin per precisione multipla, e allora
i risultati sono mostrati con 12 cifre). Se occorre esaminare un
valore più da vicino, basta per prima cosa salvarlo (si veda il
comando \cmd{genr}) e poi visualizzarlo usando il comando \cmd{print
  --ten}: verrà mostrato con 10 cifre significative.

\chapter{Analisi econometrica avanzata con software libero}
\label{app-advanced}

\app{Gretl} offre una raccolta di stimatori abbastanza completa (e in
continua crescita); inoltre dispone di vari costrutti di scripting che
possono essere usati per creare nuovi stimatori. Tuttavia, non fornisce
strumenti per la creazione e la manipolazione di matrici; se si è alla
ricerca di software libero che includa questa funzionalità, raccomandiamo
di dare un'occhiata a GNU R (\href{http://www.r-project.org/}{r-project.org}) o
GNU Octave (\href{http://www.octave.org/}{www.octave.org}). Questi programmi
sono molto simili rispettivamente ai programmi commerciali S e Matlab.
  
Come già detto sopra, \app{Gretl} offre la possibilità di
esportare i dati nei formati di Octave e R. Nel caso di Octave, il
dataset di \app{Gretl} viene salvato come matrice singola \verb+X+:
una volta importati i dati in Octave, se si vuole, è possibile
eliminare la matrice \verb+X+, si veda il manuale di Octave per i
dettagli.  Per quanto riguarda R, il file dei dati esportati conserva
qualsiasi struttura di serie storiche riconoscibile da \app{Gretl}.
Le serie sono salvate come strutture individuali: i dati vanno
importati in R con il comando \cmd{source()}.
  
Di questi due programmi, R è forse quello di più immediato interesse
per gli econometrici, visto che offre più routine statistiche specializzate.
\app{Gretl} dispone quindi di una funzione per trasferire velocemente dati in R.
Il menù Sessione di \app{Gretl} contiene il comando \textsf{Avvia GNU R}, che
salva una versione per R del dataset in uso (come file \verb+Rdata.tmp+ nella
directory Gretl dell'utente) e lo carica in una nuova sessione di R.  Di seguito
sono forniti alcuni dettagli su questa operazione.
  
Per prima cosa, i dati vengono importati in R scrivendo una versione
temporanea di \verb+.Rprofile+ nella directory di lavoro corrente (se
esiste un file di questo tipo, viene letto da R all'avvio). Se la
directory contiene una versione personale di \verb+.Rprofile+, il file
originale viene rinominato temporaneamente come
\verb+.Rprofile.gretltmp+ e viene ripristinato all'uscita da
\app{Gretl} (se qualcuno ha un'idea migliore per questa operazione, mi
farebbe piacere ascoltarla).
  
Inoltre, il modo esatto in cui R viene avviato dipende dalla variabile
interna \verb+Rcommand+ di \app{Gretl}, il cui valore deve essere
impostato nel menù \textsf{File, Preferenze}. Il comando predefinito è
\cmd{RGui.exe} in MS Windows, mentre in X è \cmd{xterm -e R}. Si noti che questa
stringa può contenere al massimo tre elementi separati da spazi:
ulteriori elementi saranno ignorati.

\chapter{Elenco degli URL}
\label{app-urls}

Quello che segue è un elenco degli URL citati nel testo.

\begin{description}

\item[Estima (RATS)] \url{http://www.estima.com/}
\item[Home page del desktop Gnome] \url{http://www.gnome.org/}
\item[Libreria GNU Multiple Precision (GMP)]
  \url{http://swox.com/gmp/}
\item[Home page di GNU Octave] \url{http://www.octave.org/}
\item[Home page di GNU RGN] \url{http://www.r-project.org/}
\item[Manuale di GNU R]
  \url{http://cran.r-project.org/doc/manuals/R-intro.pdf}
\item[Home page di Gnuplot] \url{http://www.gnuplot.info/}
\item[Manuale di Gnuplot] \url{http://ricardo.ecn.wfu.edu/gnuplot.html}
\item[Pagina dei dati di Gretl (versione italiana)]
  \url{http://gretl.sourceforge.net/gretl_data_it.html}
\item[Home page di Gretl (versione italiana)] 
  \url{http://gretl.sourceforge.net/gretl_italiano.html}
\item[Home page di GTK+] \url{http://www.gtk.org/}
\item[Home page del port di GTK+ per win32]
  \url{http://user.sgic.fi/~tml/gimp/win32/}
\item[Home page di Gtkextra] \url{http://gtkextra.sourceforge.net/}
\item[Home page di InfoZip]
  \url{http://www.info-zip.org/pub/infozip/zlib/}
\item[JRSoftware] \url{http://www.jrsoftware.org/}
\item[Home page di Mingw (gcc per win32)] \url{http://www.mingw.org/}
\item[Minpack] \url{http://www.netlib.org/minpack/}
\item[Penn World Table] \url{http://pwt.econ.upenn.edu/}
\item[Home page di Readline]
  \url{http://cnswww.cns.cwru.edu/~chet/readline/rltop.html}
\item[Manuale di Readline]
  \url{http://cnswww.cns.cwru.edu/~chet/readline/readline.html}
\item[Home page di Xmlsoft] \url{http://xmlsoft.org/}

\end{description}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "gretl-guide-it"
%%% End: 

