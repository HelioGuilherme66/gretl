 <chapter id="chap-graphs"><title>Graphs and plots</title>

  <sect1 id="gnuplot-graphs"><title>Gnuplot graphs</title>

    <para>A separate program, <application>gnuplot</application>, is
      called to generate graphs. Gnuplot is a very full-featured
      graphing program with myriad options. It is available from
      <ulink url="http://www.gnuplot.info/">www.gnuplot.info</ulink>
      (but note that a copy of gnuplot is bundled with the MS Windows
      version of <application>gretl</application>).
      <application>gretl</application> gives you direct access, via a
      graphical interface, to a subset of gnuplot's options and it
      tries to choose sensible values for you; it also allows you to
      take complete control over graph details if you wish.</para>

    <para>With a graph displayed, you can click on the graph window
      for a pop-up menu with the following options.</para>

    <itemizedlist>
      <listitem><para><guimenuitem>Save as postscript</guimenuitem>:
	  Save the graph in encapsulated postscript (EPS)
	  format.</para>
      </listitem>
      <listitem><para><guimenuitem>Save as PNG</guimenuitem>: Save in
	  Portable Network Graphics format.</para>
      </listitem>
      <listitem><para><guimenuitem>Save to session as
	    icon</guimenuitem>: The graph will appear in iconic form
	  when you select "Icon view" from the Session menu.</para>
      </listitem>
      <listitem><para><guimenuitem>Zoom</guimenuitem>: Lets you select
	  an area within the graph for closer inspection (not
	  available for all graphs).</para>
      </listitem>
      <listitem><para><guimenuitem>Print</guimenuitem>: On the Gnome
	  desktop only, lets you print the graph directly.</para>
      </listitem>
      <listitem><para><guimenuitem>Copy to clipboard</guimenuitem>: MS
	  Windows only, lets you paste the graph into Windows
	  applications such as MS Word.<footnote><para>For best
	  results when pasting graphs into MS Office applications,
	  choose the application's <quote>Edit, Paste
	  Special...</quote> menu item, and select the option
	  <quote>Picture (Enhanced Metafile)</quote>.</para>
	  </footnote></para>
      </listitem>
      <listitem><para><guimenuitem>Edit</guimenuitem>: Opens a
	  controller for the plot which lets you adjust various
	  aspects of its appearance.</para></listitem>
      <listitem><para><guimenuitem>Close</guimenuitem>: Closes the
	  graph window.</para>
      </listitem>
    </itemizedlist>

    <para>If you know something about
      <application>gnuplot</application> and wish to get finer control
      over the appearance of a graph than is available via the
      graphical controller (<quote>Edit</quote> option), you have two
      further options.</para>

    <itemizedlist>
      <listitem><para>Once the graph is saved as a session icon, you
	  can right-click on its icon for a further pop-up menu.  One
	  of the otions here is <quote>Edit plot commands</quote>,
	  which opens an editing window with the actual gnuplot
	  commands displayed. You can edit these commands and either
	  save them for future processing or send them to gnuplot
	  (with the <quote>File/Send to gnuplot</quote> menu item in
	  the plot commands editing window).</para>
      </listitem>
      <listitem><para>Another way to save the plot commands (or to
	  save the displayed plot in formats other than EPS or PNG) is
	  to use <quote>Edit</quote> item on a graph's pop-up menu to
	  invoke the graphical controller, then click on the
	  <quote>Output to file</quote> tab in the controller.  You
	  are then presented with a drop-down menu of formats in which
	  to save the graph.</para>
      </listitem>
    </itemizedlist>

    <para>To find out more about <application>gnuplot</application>
      see the <ulink
	url="http://ricardo.ecn.wfu.edu/gnuplot.html">online
	manual</ulink> or <ulink
	url="http://www.gnuplot.info/">www.gnuplot.info</ulink>.</para>

    <para>See also the entry for <command>gnuplot</command> in 
      <xref linkend="cmdref"/> below &mdash; and the
      <command>graph</command> and <command>plot</command> commands
      for <quote>quick and dirty</quote> ASCII graphs.</para>

    <figure id="fig-plot" float="1" pgwide="1">
      <title>gretl's gnuplot controller</title>
      <screenshot>
	<screeninfo>gnuplot controller</screeninfo>
	<graphic fileref="figures/plot_control" align="center"/>
      </screenshot>
    </figure>

  </sect1>

    <sect1 id="sect-boxplots"><title>Boxplots</title>

      <para>Boxplots are not generated using gnuplot, but rather by
	<application>gretl</application> itself.</para>

      <para>These plots (after Tukey and Chambers) display the
	distribution of a variable. The central box encloses the
	middle 50 percent of the data, i.e. it is bounded by the first
	and third quartiles.  The <quote>whiskers</quote> extend to
	the minimum and maximum values.  A line is drawn across the
	box at the median.</para> 

      <para>In the case of notched boxes, the notch shows the limits
	of an approximate 90 percent confidence interval.  This is
	obtained by the bootstrap method, which can take a while if
	the data series is very long.</para>

      <para>Clicking the mouse in the boxplots window brings up a menu
	which enables you to save the plots as encapsulated postscript
	(EPS) or as a full-page postscript file.  Under the X window
	system you can also save the window as an XPM file; under MS
	Windows you can copy it to the clipboard as a bitmap.  The
	menu also gives you the option of opening a summary window
	which displays five-number summaries (minimum, first quartile,
	median, third quartile, maxmimum), plus a confidence interval
	for the median if the <quote>notched</quote> option was
	chosen.
      </para>

      <para>Some details of gretl's boxplots can be controlled via a
	(plain text) file named <filename>.boxplotrc</filename> which
	is looked for, in turn, in the current working directory, the
	user's home directory (corresponding to the environment
	variable <envar>HOME</envar>) and the gretl user directory
	(which is displayed and may be changed under the <quote>File,
	  Preferences, General</quote> menu).  Options that can be set
	in this way are the font to use when producing postscript
	output (must be a valid generic postscript font name; the
	default is Helvetica), the size of the font in points (also
	for postscript output; default is 12), the minimum and maximum
	for the y-axis range, the width and height of the plot in
	pixels (default, 560 x 448), whether numerical values should
	be printed for the quartiles and median (default, don't print
	them), and whether outliers (points lying beyond 1.5 times the
	interquartile range from the central box) should be indicated
	separately (default, no).  Here is an example:</para>

      <programlisting>
font = Times-Roman
fontsize = 16
max = 4.0
min = 0
width = 400
height = 448
numbers = %3.2f
outliers = true
      </programlisting>

      <para>On the second to last line, the value associated with
	<literal>numbers</literal> is a <quote>printf</quote> format
	string as in the C programming language; if specified, this
	controls the printing of the median and quartiles next to the
	boxplot, if no <literal>numbers</literal> entry is given these
	values are not printed.  In the example, the values will be
	printed to a width of 3 digits, with 2 digits of precision
	following the decimal point.</para>

      <para>Not all of the options need be specified, and the order
	doesn't matter.  Lines not matching the pattern <quote>key =
	  value</quote> are ignored, as are lines that begin with the
	hash mark, <literal>#</literal>.</para>

      <para>After each variable specified in the boxplot command, a
	parenthesized boolean expression may be added, to limit the
	sample for the variable in question.  A space must be inserted
	between the variable name or number and the expression.
	Suppose you have salary figures for men and women, and you
	have a dummy variable <literal>GENDER</literal> with value 1
	for men and 0 for women.  In that case you could draw
	comparative boxplots with the following line in the boxplots
	dialog:</para>
      <programlisting>
      salary (GENDER=1) salary (GENDER=0)
      </programlisting>

    </sect1>

  </chapter>

<!-- Keep this comment at the end of the file
Local variables:
sgml-default-dtd-file:"../manual.ced"
mode: xml
sgml-parent-document:("../manual.xml" "book" "chapter")
End:
-->

