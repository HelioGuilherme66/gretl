<HTML
><HEAD
><TITLE
>Numerical accuracy</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Gretl Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="Nonlinear least squares"
HREF="c1141.html"><LINK
REL="PREVIOUS"
TITLE="Details on the code"
HREF="x1205.html"><LINK
REL="NEXT"
TITLE="Loop constructs"
HREF="c1320.html"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Gretl Manual: Gnu Regression, Econometrics and Time-series
      Library</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x1205.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 7. Nonlinear least squares</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="c1320.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="nls-accuracy"
></A
>Numerical accuracy</H1
><P
><A
HREF="x1238.html#tab-nls"
>Table 7-1</A
> shows the results of running the
      <TT
CLASS="application"
>gretl</TT
> NLS procedure on the 27
      Statistical Reference Datasets made available by the U.S.
      National Institute of Standards and Technology (NIST) for
      testing nonlinear regression software.<A
NAME="AEN1243"
HREF="#FTN.AEN1243"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
> For each dataset, two sets of starting values for
      the parameters are given in the test files, so the full test
      comprises 54 runs.  Two full tests were performed, one using all
      analytical derivatives and one using all numerical
      approximations. In each case the default tolerance was
      used.<A
NAME="AEN1247"
HREF="#FTN.AEN1247"
><SPAN
CLASS="footnote"
>[2]</SPAN
></A
></P
><P
>Out of the 54 runs, <TT
CLASS="application"
>gretl</TT
> failed
      to produce a solution in 4 cases when using analytical
      derivatives, and in 5 cases when using numeric approximation. Of
      the four failures in analytical derivatives mode, two were due
      to non-convergence of the Levenberg&#8211;Marquandt algorithm
      after the maximum number of iterations (on
      <TT
CLASS="filename"
>MGH09</TT
> and <TT
CLASS="filename"
>Bennett5</TT
>,
      both described by NIST as of <SPAN
CLASS="QUOTE"
>"Higher difficulty"</SPAN
>)
      and two were due to generation of range errors (out-of-bounds
      floating point values) when computing the Jacobian (on
      <TT
CLASS="filename"
>BoxBOD</TT
> and <TT
CLASS="filename"
>MGH17</TT
>,
      described as of <SPAN
CLASS="QUOTE"
>"Higher difficulty"</SPAN
> and
      <SPAN
CLASS="QUOTE"
>"Average difficulty"</SPAN
> respectively).  The additional
      failure in numerical approximation mode was on
      <TT
CLASS="filename"
>MGH10</TT
> (<SPAN
CLASS="QUOTE"
>"Higher difficulty"</SPAN
>,
      maximum number of iterations reached).</P
><P
>The table gives information on several aspects of the tests:
      the number of outright failures, the average number of
      iterations taken to produce a solution and two sorts of measure
      of the accuracy of the estimates for both the parameters and the
      standard errors of the parameters.</P
><P
>For each of the 54 runs in each mode, if the run produced a
      solution the parameter estimates obtained by
      <TT
CLASS="application"
>gretl</TT
> were compared with the NIST
      certified values.  We define the <SPAN
CLASS="QUOTE"
>"minimum correct
	figures"</SPAN
> for a given run as the number of significant
      figures to which the <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>least accurate</I
></SPAN
>
      <TT
CLASS="application"
>gretl</TT
> estimate agreed with the
      certified value, for that run. The table shows both the average
      and the worst case value of this variable across all the runs
      that produced a solution.  The same information is shown for the
      estimated standard errors.<A
NAME="AEN1269"
HREF="#FTN.AEN1269"
><SPAN
CLASS="footnote"
>[3]</SPAN
></A
></P
><P
>&#13;      The second measure of accuracy shown is the percentage of cases,
      taking into account all parameters from all successful runs, in
      which the <TT
CLASS="application"
>gretl</TT
> estimate agreed with
      the certified value to at least the 6 significant figures which
      are printed by default in the <TT
CLASS="application"
>gretl</TT
>
      regression output.</P
><DIV
CLASS="table"
><A
NAME="tab-nls"
></A
><P
><B
>Table 7-1. Nonlinear regression: the NIST tests</B
></P
><TABLE
BORDER="0"
CLASS="CALSTABLE"
><THEAD
><TR
><TH
ALIGN="LEFT"
VALIGN="MIDDLE"
> </TH
><TH
ALIGN="LEFT"
VALIGN="MIDDLE"
>Analytical derivatives</TH
><TH
ALIGN="LEFT"
VALIGN="MIDDLE"
>Numerical derivatives</TH
></TR
></THEAD
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Failures in 54 tests</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>4</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>5</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Average iterations</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>32</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>127</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Avg. of min. correct figures, parameters</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>8.120</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>6.980</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Worst of min. correct figures, parameters</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>4</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>3</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Avg. of min. correct figures, standard
	      errors</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>8.000</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>5.673</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Worst of min. correct figures, standard
	      errors</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>5</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>2</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Percent correct to at least 6 figures,
	      parameters</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>96.5</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>91.9</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Percent correct to at least 6 figures, standard
	      errors</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>97.7</TD
><TD
ALIGN="CENTER"
VALIGN="MIDDLE"
>77.3</TD
></TR
></TBODY
></TABLE
></DIV
><P
>Using analytical derivatives, the worst case values for both
      parameters and standard errors were improved to 6 correct
      figures on the test machine when the tolerance was tightened to
      1.0e&#8722;14.  Using numerical derivatives, the same tightening
      of the tolerance raised the worst values to 5 correct figures
      for the parameters and 3 figures for standard errors, at a cost
      of one additional failure of convergence.</P
><P
>Note the overall superiority of analytical derivatives: on
      average solutions to the test problems were obtained with
      substantially fewer iterations and the results were more
      accurate (most notably for the estimated standard errors).  Note
      also that the six-digit results printed by
      <TT
CLASS="application"
>gretl</TT
> are not 100 percent reliable
      for difficult nonlinear problems (in particular when using
      numerical derivatives).  Having registered this caveat, the
      percentage of cases where the results were good to six digits or
      better seems high enough to justify their printing in this
      form.</P
></DIV
><H3
CLASS="FOOTNOTES"
>Notes</H3
><TABLE
BORDER="0"
CLASS="FOOTNOTES"
WIDTH="100%"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN1243"
HREF="x1238.html#AEN1243"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>For a
	  discussion of <TT
CLASS="application"
>gretl</TT
>'s accuracy in
	  the estimation of linear models, see <A
HREF="a4470.html"
>Appendix C</A
>.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN1247"
HREF="x1238.html#AEN1247"
><SPAN
CLASS="footnote"
>[2]</SPAN
></A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>The data shown in the table were gathered
	  from a pre-release build of <TT
CLASS="application"
>gretl</TT
>
	  version 1.0.9, compiled with <TT
CLASS="application"
>gcc</TT
>
	  3.3, linked against <TT
CLASS="application"
>glibc</TT
> 2.3.2,
	  and run under Linux on an i686 PC (IBM ThinkPad
	  A21m).</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN1269"
HREF="x1238.html#AEN1269"
><SPAN
CLASS="footnote"
>[3]</SPAN
></A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>For the standard
	  errors, I excluded one outlier from the statistics shown in the
	  table, namely <TT
CLASS="filename"
>Lanczos1</TT
>.  This is an odd
	  case, using generated data with an almost-exact fit: the
	  standard errors are 9 or 10 orders of magnitude smaller than
	  the coefficients.  In this instance
	  <TT
CLASS="application"
>gretl</TT
> could reproduce the
	  certified standard errors to only 3 figures (analytical
	  derivatives) and 2 figures (numerical derivatives).</P
></TD
></TR
></TABLE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x1205.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="c1320.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Details on the code</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c1141.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Loop constructs</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>