gretl version 2016b-git
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2016-02-04 10:01
? run pwe.inp
 /home/cottrell/stats/test-gretl/fcast/pwe.inp
? open data9-7

Read datafile /opt/esl/share/gretl/data/data9-7.gdt
periodicity: 4, maxobs: 64
observations range: 1975:1 to 1990:4

Listing 12 variables:
  0) const     1) QNC       2) PRICE     3) INCOME    4) PRIME   
  5) UNEMP     6) STOCK     7) POP       8) WINTER    9) SPRING  
 10) SUMMER   11) FALL    

? list XL = 0 PRICE INCOME PRIME
Generated list XL
? matrix X = { XL }
Generated matrix X
# get PWE estimates
? ar1 QNC XL --pwe

Performing iterative calculation of rho...

                 ITER       RHO        ESS
                   1      0.36147   4.00020e+06
                   2      0.36830   3.99860e+06
                   3      0.36855   3.99855e+06
                   4      0.36856   3.99855e+06
                   5      0.36856   3.99855e+06

Model 1: Prais-Winsten, using observations 1975:1-1990:4 (T = 64)
Dependent variable: QNC
rho = 0.368561

             coefficient   std. error   t-ratio   p-value
  -------------------------------------------------------
  const       -548.898     1270.96      -0.4319   0.6674 
  PRICE        -19.4088       8.20734   -2.365    0.0213  **
  INCOME       485.805      181.201      2.681    0.0095  ***
  PRIME        -21.9784      15.7661    -1.394    0.1685 

Statistics based on the rho-differenced data:

Mean dependent var   2488.594   S.D. dependent var   332.9220
Sum squared resid     3998547   S.E. of regression   258.1520
R-squared            0.427493   Adjusted R-squared   0.398868
F(3, 60)             3.836682   P-value(F)           0.013998
rho                 -0.008814   Durbin-Watson        1.928459

Excluding the constant, p-value was highest for variable 4 (PRIME)

# save various things
? uh1 = $uhat
Generated series uh1 (ID 12)
? yh1 = $yhat
Generated series yh1 (ID 13)
? scalar r = $rho
Generated scalar r = 0.368561
? matrix b = $coeff
Generated matrix b
# series for manual computations
? series uh2
? series yh2
# PWE special for first obs
? scalar pw1 = sqrt(1.0 - r * r)
Generated scalar pw1 = 0.929603
? scalar T = $T
Generated scalar T = 64
? scalar et
? loop i=1..T --quiet
> if (i == 1)
> et = pw1 * (QNC[i] - X[i,] * b)
> else
> et = QNC[i] - r * QNC[i-1]
> et -= (X[i,] - r * X[i-1,]) * b
> endif
> uh2[i] = et
> yh2[i] = QNC[i] - et
> endloop
# compare automatic and manual values
? print QNC yh1 yh2 uh1 uh2 --byobs

                QNC          yh1          yh2          uh1          uh2

1975:1         1923     2413.163     2413.163    -490.1633    -490.1633
1975:2         2165     2332.815     2332.815    -167.8155    -167.8155
1975:3         2198     2385.970     2385.970    -187.9701    -187.9701
1975:4         2328     2447.196     2447.196    -119.1963    -119.1963
1976:1         2381     2498.964     2498.964    -117.9643    -117.9643
1976:2         2788     2524.339     2524.339     263.6615     263.6615
1976:3         2416     2674.416     2674.416    -258.4164    -258.4164
1976:4         2513     2499.000     2499.000      14.0002      14.0002
1977:1         2617     2602.656     2602.656      14.3443      14.3443
1977:2         3195     2618.515     2618.515     576.4851     576.4851
1977:3         2668     2868.662     2868.662    -200.6619    -200.6619
1977:4         2688     2646.623     2646.623      41.3773      41.3773
1978:1         2540     2619.524     2619.524     -79.5239     -79.5239
1978:2         3337     2673.668     2673.668     663.3321     663.3321
1978:3         2713     2899.745     2899.745    -186.7453    -186.7453
1978:4         2710     2658.866     2658.866      51.1338      51.1338
1979:1         2739     2630.581     2630.581     108.4188     108.4188
1979:2         2942     2604.121     2604.121     337.8790     337.8790
1979:3         2571     2663.452     2663.452     -92.4520     -92.4520
1979:4         2396     2429.039     2429.039     -33.0389     -33.0389
1980:1         2511     2375.226     2375.226     135.7738     135.7738
1980:2         2139     2282.284     2282.284    -143.2835    -143.2835
1980:3         2130     2291.978     2291.978    -161.9779    -161.9779
1980:4         2189     2142.922     2142.922      46.0781      46.0781
1981:1         2373     2165.363     2165.363     207.6367     207.6367
1981:2         2207     2210.039     2210.039      -3.0392      -3.0392
1981:3         2192     2100.337     2100.337      91.6635      91.6635
1981:4         1754     2177.987     2177.987    -423.9866    -423.9866
1982:1         1944     1920.816     1920.816      23.1840      23.1840
1982:2         2094     2074.601     2074.601      19.3990      19.3990
1982:3         1910     2097.638     2097.638    -187.6382    -187.6382
1982:4         2032     2077.669     2077.669     -45.6690     -45.6690
1983:1         2045     2161.144     2161.144    -116.1436    -116.1436
1983:2         2505     2163.653     2163.653     341.3473     341.3473
1983:3         2237     2372.445     2372.445    -135.4452    -135.4452
1983:4         2394     2282.587     2282.587     111.4128     111.4128
1984:1         2584     2428.117     2428.117     155.8830     155.8830
1984:2         2895     2473.886     2473.886     421.1137     421.1137
1984:3         2448     2577.645     2577.645    -129.6454    -129.6454
1984:4         2463     2445.920     2445.920      17.0803      17.0803
1985:1         2644     2511.393     2511.393     132.6070     132.6070
1985:2         2988     2599.788     2599.788     388.2119     388.2119
1985:3         2968     2653.840     2653.840     314.1595     314.1595
1985:4         2442     2667.755     2667.755    -225.7549    -225.7549
1986:1         2600     2522.950     2522.950      77.0504      77.0504
1986:2         3046     2701.228     2701.228     344.7715     344.7715
1986:3         3124     2725.582     2725.582     398.4179     398.4179
1986:4         2689     2757.398     2757.398     -68.3981     -68.3981
1987:1         2341     2594.481     2594.481    -253.4813    -253.4813
1987:2         2767     2284.205     2284.205     482.7948     482.7948
1987:3         2785     2657.374     2657.374     127.6257     127.6257
1987:4         2382     2675.523     2675.523    -293.5227    -293.5227
1988:1         2636     2554.568     2554.568      81.4321      81.4321
1988:2         2864     2647.524     2647.524     216.4763     216.4763
1988:3         2556     2782.333     2782.333    -226.3333    -226.3333
1988:4         2486     2643.108     2643.108    -157.1084    -157.1084
1989:1         2337     2579.679     2579.679    -242.6793    -242.6793
1989:2         2757     2517.098     2517.098     239.9017     239.9017
1989:3         2631     2735.219     2735.219    -104.2187    -104.2187
1989:4         2053     2643.680     2643.680    -590.6799    -590.6799
1990:1         2310     2444.494     2444.494    -134.4939    -134.4939
1990:2         2532     2554.947     2554.947     -22.9472     -22.9472
1990:3         2358     2632.758     2632.758    -274.7580    -274.7580
1990:4         2100     2438.047     2438.047    -338.0466    -338.0466

Done
