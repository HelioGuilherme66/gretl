gretl version 1.9.6cvs
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2011-11-11 16:31
? run marry_m.inp
 /home/cottrell/stats/test-gretl/vecm/marry_m.inp
? function void eigensort (matrix *evals, matrix *evecs, int r)
? open marry2.xls --quiet
Excel 97 +
rows=65, total cols=2, data cols=2
check for label strings in first imported column: not found
Read datafile /home/cottrell/stats/test-gretl/vecm/marry2.xls
? set messages off
? setobs 1 1947 --time-series
? genr time
? genr I76 = (t == 30)
? lags 1; I76
? genr Sh76 = (t >= 30)
? lags 2; Sh76
? genr Tr76 = time * Sh76
? lags 2; Tr76
? list Y = Men Women
? list dY = diff(Y)
? list Y_1 = lags(1, Y)
? print Men Women d_Men d_Women Men_1 Women_1 Sh76 I76 Tr76_2 --byobs

              Men        Women        d_Men      d_Women        Men_1

1947         23.7         20.5                                       
1948         23.3         20.4         -0.4         -0.1         23.7
1949         22.7         20.3         -0.6         -0.1         23.3
1950         22.8         20.3          0.1          0.0         22.7
1951         22.9         20.4          0.1          0.1         22.8
1952         23.0         20.2          0.1         -0.2         22.9
1953         22.8         20.2         -0.2          0.0         23.0
1954         23.0         20.3          0.2          0.1         22.8
1955         22.6         20.2         -0.4         -0.1         23.0
1956         22.5         20.1         -0.1         -0.1         22.6
1957         22.6         20.3          0.1          0.2         22.5
1958         22.6         20.2          0.0         -0.1         22.6
1959         22.5         20.2         -0.1          0.0         22.6
1960         22.8         20.3          0.3          0.1         22.5
1961         22.8         20.3          0.0          0.0         22.8
1962         22.7         20.3         -0.1          0.0         22.8
1963         22.8         20.5          0.1          0.2         22.7
1964         23.1         20.5          0.3          0.0         22.8
1965         22.8         20.6         -0.3          0.1         23.1
1966         22.8         20.5          0.0         -0.1         22.8
1967         23.1         20.6          0.3          0.1         22.8
1968         23.1         20.8          0.0          0.2         23.1
1969         23.2         20.8          0.1          0.0         23.1
1970         23.2         20.8          0.0          0.0         23.2
1971         23.1         20.9         -0.1          0.1         23.2
1972         23.3         20.9          0.2          0.0         23.1
1973         23.2         21.0         -0.1          0.1         23.3
1974         23.1         21.1         -0.1          0.1         23.2
1975         23.5         21.1          0.4          0.0         23.1
1976         23.8         21.3          0.3          0.2         23.5
1977         24.0         21.6          0.2          0.3         23.8
1978         24.2         21.8          0.2          0.2         24.0
1979         24.4         22.1          0.2          0.3         24.2
1980         24.7         22.0          0.3         -0.1         24.4
1981         24.8         22.3          0.1          0.3         24.7
1982         25.2         22.5          0.4          0.2         24.8
1983         25.4         22.8          0.2          0.3         25.2
1984         25.4         23.0          0.0          0.2         25.4
1985         25.5         23.3          0.1          0.3         25.4
1986         25.7         23.1          0.2         -0.2         25.5
1987         25.8         23.6          0.1          0.5         25.7
1988         25.9         23.6          0.1          0.0         25.8
1989         26.2         23.8          0.3          0.2         25.9
1990         26.1         23.9         -0.1          0.1         26.2
1991         26.3         24.1          0.2          0.2         26.1
1992         26.5         24.4          0.2          0.3         26.3
1993         26.5         24.5          0.0          0.1         26.5
1994         26.7         24.5          0.2          0.0         26.5
1995         26.9         24.5          0.2          0.0         26.7
1996         27.1         24.8          0.2          0.3         26.9
1997         26.8         25.0         -0.3          0.2         27.1
1998         26.7         25.0         -0.1          0.0         26.8
1999         26.9         25.1          0.2          0.1         26.7
2000         26.8         25.1         -0.1          0.0         26.9
2001         26.9         25.1          0.1          0.0         26.8
2002         26.9         25.3          0.0          0.2         26.9
2003         27.1         25.3          0.2          0.0         26.9
2004         27.4         25.3          0.3          0.0         27.1
2005         27.1         25.3         -0.3          0.0         27.4
2006         27.5         25.5          0.4          0.2         27.1
2007         27.5         25.6          0.0          0.1         27.5
2008         27.6         25.9          0.1          0.3         27.5
2009         28.2         26.1          0.6          0.2         27.6
2010         28.1         25.9         -0.1         -0.2         28.2

          Women_1         Sh76          I76       Tr76_2

1947                         0            0             
1948         20.5            0            0             
1949         20.4            0            0            0
1950         20.3            0            0            0
1951         20.3            0            0            0
1952         20.4            0            0            0
1953         20.2            0            0            0
1954         20.2            0            0            0
1955         20.3            0            0            0
1956         20.2            0            0            0
1957         20.1            0            0            0
1958         20.3            0            0            0
1959         20.2            0            0            0
1960         20.2            0            0            0
1961         20.3            0            0            0
1962         20.3            0            0            0
1963         20.3            0            0            0
1964         20.5            0            0            0
1965         20.5            0            0            0
1966         20.6            0            0            0
1967         20.5            0            0            0
1968         20.6            0            0            0
1969         20.8            0            0            0
1970         20.8            0            0            0
1971         20.8            0            0            0
1972         20.9            0            0            0
1973         20.9            0            0            0
1974         21.0            0            0            0
1975         21.1            0            0            0
1976         21.1            1            1            0
1977         21.3            1            0            0
1978         21.6            1            0           30
1979         21.8            1            0           31
1980         22.1            1            0           32
1981         22.0            1            0           33
1982         22.3            1            0           34
1983         22.5            1            0           35
1984         22.8            1            0           36
1985         23.0            1            0           37
1986         23.3            1            0           38
1987         23.1            1            0           39
1988         23.6            1            0           40
1989         23.6            1            0           41
1990         23.8            1            0           42
1991         23.9            1            0           43
1992         24.1            1            0           44
1993         24.4            1            0           45
1994         24.5            1            0           46
1995         24.5            1            0           47
1996         24.5            1            0           48
1997         24.8            1            0           49
1998         25.0            1            0           50
1999         25.0            1            0           51
2000         25.1            1            0           52
2001         25.1            1            0           53
2002         25.1            1            0           54
2003         25.3            1            0           55
2004         25.3            1            0           56
2005         25.3            1            0           57
2006         25.3            1            0           58
2007         25.5            1            0           59
2008         25.6            1            0           60
2009         25.9            1            0           61
2010         26.1            1            0           62

? smpl +2 ;
? matrix mX = {const, Sh76, I76}
? matrix mY = {dY} ~ {Y_1} ~ {Tr76_2}
? scalar T = rows(mX)
? scalar n = nelem(Y)
? matrix U
? mols(mY, mX, &U)
? U0 = U[,1:n]
? U1 = U[,n+1:]
? matrix S00 = U0'U0 ./ T
? print S00
S00 (2 x 2)

    0.039431    0.0053718 
   0.0053718     0.017895 

? matrix S11 = U1'U1 ./ T
? print S11
S11 (3 x 3)

     0.70092      0.82938       6.8806 
     0.82938       1.0261       8.3708 
      6.8806       8.3708       81.383 

? matrix S01 = U0'U1 ./ T
? print S01
S01 (2 x 3)

   -0.039239    -0.024765     -0.20133 
   -0.031484    -0.043159     -0.35123 

? matrix A = qform(S01', inv(S00))
? matrix evecs
? matrix evals = eigsolve(A, S11, &evecs)
? eigensort(&evals, &evecs, n)
? print evals
evals (2 x 1)

     0.38945 
     0.10464 

? print evecs
evecs (3 x 2)

      5.8166     -0.21923 
     -4.3241     -0.83813 
   -0.050833    0.0035349 

Done
