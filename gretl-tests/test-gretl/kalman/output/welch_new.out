gretl version 2016b-git
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2016-04-06 11:16
? run welch_new.inp
 /home/cottrell/stats/test-gretl/kalman/welch_new.inp
? nulldata 50
periodicity: 1, maxobs: 50
observations range: 1 to 50
? setobs 1 1 --special
Full data range: 1 - 50 (n = 50)

# Replicate the example at
# http://www.cs.unc.edu/~welch/kalman/kalmanIntro.html
? scalar T = 50
Generated scalar T = 50
? scalar mu = -0.37727
Generated scalar mu = -0.37727
? series y = mread("y.mat")
Generated series y (ID 2)
? matrix V = zeros(T,1)
Generated matrix V
? matrix St = zeros(T,1)
Generated matrix St
? matrix L = zeros(T,1)
Generated matrix L
? bundle kb = ksetup({y}, {1}, {1}, {1.0e-5})
? kb.obsvar = {0.01}
? kb.inivar = {1}
? err = kfilter(kb)
Generated scalar err = 0
LL = 45.7883
s2 = 0.757684
? series e = kb.prederr
Generated series e (ID 3)
? print y e -o

                y            e

   1   -0.3996309   -0.3996309
   2   -0.3952327    0.0004415
   3   -0.3888566     0.006598
   4   -0.2721689    0.1210899
   5   -0.3189654      0.04399
   6   -0.3960891     -0.04197
   7   -0.4341591     -0.07299
   8   -0.4525552     -0.08084
   9   -0.5019381   -0.1199530
  10   -0.2748781    0.1207209
  11   -0.3305302      0.05267
  12   -0.3830335    -0.004786
  13   -0.5598139   -0.1811513
  14   -0.4006861    -0.007411
  15   -0.4640941     -0.07026
  16   -0.4824181     -0.08359
  17   -0.4164745     -0.01203
  18   -0.3043813    0.1008334
  19   -0.3329668      0.06611
  20   -0.4527699     -0.05755
  21   -0.2795147    0.1189258
  22   -0.4539258     -0.06190
  23   -0.3688166      0.02643
  24   -0.4807488     -0.08683
  25   -0.3062539      0.09191
  26   -0.2891515    0.1046453
  27   -0.5237397   -0.1347834
  28   -0.2969516      0.09809
  29   -0.2681310    0.1225826
  30   -0.3842793     0.001145
  31   -0.3763542     0.009022
  32   -0.4002809     -0.01528
  33   -0.2597239    0.1259009
  34   -0.2839975      0.09658
  35   -0.3473842      0.02938
  36   -0.4274438     -0.05182
  37   -0.2016459    0.1759669
  38   -0.4873963   -0.1164464
  39   -0.2868321      0.08847
  40   -0.4406104     -0.06858
  41   -0.5065628   -0.1320194
  42   -0.2732169    0.1061105
  43   -0.5437540   -0.1682360
  44   -0.3042437      0.07726
  45   -0.4493286     -0.07055
  46   -0.3686142      0.01263
  47   -0.4857835   -0.1049738
  48   -0.3208438      0.06359
  49   -0.4208338     -0.03858
  50   -0.2484403    0.1351287

? err = ksmooth(kb)
Replaced scalar err = 0
? matrix out2 = kb.state ~ kb.stvar
Generated matrix out2
? out2
out2 (50 x 2)

    -0.38299   0.00033911 
    -0.38298   0.00032979 
    -0.38295   0.00032110 
    -0.38292   0.00031300 
    -0.38300   0.00030546 
    -0.38314   0.00029847 
    -0.38327   0.00029197 
    -0.38335   0.00028596 
    -0.38337   0.00028040 
    -0.38326   0.00027527 
    -0.38326   0.00027056 
    -0.38331   0.00026624 
    -0.38337   0.00026230 
    -0.38324   0.00025872 
    -0.38310   0.00025549 
    -0.38288   0.00025259 
    -0.38256   0.00025001 
    -0.38221   0.00024774 
    -0.38193   0.00024578 
    -0.38170   0.00024411 
    -0.38140   0.00024273 
    -0.38120   0.00024164 
    -0.38093   0.00024082 
    -0.38068   0.00024028 
    -0.38032   0.00024001 
    -0.38004   0.00024001 
    -0.37984   0.00024028 
    -0.37951   0.00024083 
    -0.37925   0.00024165 
    -0.37911   0.00024275 
    -0.37896   0.00024413 
    -0.37881   0.00024580 
    -0.37865   0.00024777 
    -0.37860   0.00025003 
    -0.37865   0.00025262 
    -0.37872   0.00025552 
    -0.37875   0.00025876 
    -0.37896   0.00026234 
    -0.37906   0.00026628 
    -0.37925   0.00027061 
    -0.37937   0.00027532 
    -0.37938   0.00028045 
    -0.37948   0.00028601 
    -0.37943   0.00029203 
    -0.37944   0.00029853 
    -0.37939   0.00030554 
    -0.37935   0.00031308 
    -0.37920   0.00032118 
    -0.37912   0.00032988 
    -0.37899   0.00033921 

? delete kb
Deleted kb
Done
