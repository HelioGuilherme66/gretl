gretl version 2016b-git
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2016-04-02 10:37
? run welch_koop.inp
 /home/cottrell/stats/test-gretl/kalman/welch_koop.inp
? nulldata 50
periodicity: 1, maxobs: 50
observations range: 1 to 50
? setobs 1 1 --special
Full data range: 1 - 50 (n = 50)

# Replicate the example at
# http://www.cs.unc.edu/~welch/kalman/kalmanIntro.html
? scalar T = 50
Generated scalar T = 50
? scalar mu = -0.37727
Generated scalar mu = -0.37727
? series y = mread("y.mat")
Generated series y (ID 2)
? matrix V = zeros(T,1)
Generated matrix V
? matrix St = zeros(T,1)
Generated matrix St
? matrix L = zeros(T,1)
Generated matrix L
? kalman
? obsy y
? obsymat 1
? obsvar 0.01
? statemat 1
? statevar 1.0e-5
? inivar 1
? end kalman
? matrix em
? kfilter(&em)
LL = 45.7883
s2 = 0.757684
? series e = em
Generated series e (ID 3)
? print y e -o

                y            e

   1   -0.3996309   -0.3996309
   2   -0.3952327    0.0004415
   3   -0.3888566     0.006598
   4   -0.2721689    0.1210899
   5   -0.3189654      0.04399
   6   -0.3960891     -0.04197
   7   -0.4341591     -0.07299
   8   -0.4525552     -0.08084
   9   -0.5019381   -0.1199530
  10   -0.2748781    0.1207209
  11   -0.3305302      0.05267
  12   -0.3830335    -0.004786
  13   -0.5598139   -0.1811513
  14   -0.4006861    -0.007411
  15   -0.4640941     -0.07026
  16   -0.4824181     -0.08359
  17   -0.4164745     -0.01203
  18   -0.3043813    0.1008334
  19   -0.3329668      0.06611
  20   -0.4527699     -0.05755
  21   -0.2795147    0.1189258
  22   -0.4539258     -0.06190
  23   -0.3688166      0.02643
  24   -0.4807488     -0.08683
  25   -0.3062539      0.09191
  26   -0.2891515    0.1046453
  27   -0.5237397   -0.1347834
  28   -0.2969516      0.09809
  29   -0.2681310    0.1225826
  30   -0.3842793     0.001145
  31   -0.3763542     0.009022
  32   -0.4002809     -0.01528
  33   -0.2597239    0.1259009
  34   -0.2839975      0.09658
  35   -0.3473842      0.02938
  36   -0.4274438     -0.05182
  37   -0.2016459    0.1759669
  38   -0.4873963   -0.1164464
  39   -0.2868321      0.08847
  40   -0.4406104     -0.06858
  41   -0.5065628   -0.1320194
  42   -0.2732169    0.1061105
  43   -0.5437540   -0.1682360
  44   -0.3042437      0.07726
  45   -0.4493286     -0.07055
  46   -0.3686142      0.01263
  47   -0.4857835   -0.1049738
  48   -0.3208438      0.06359
  49   -0.4208338     -0.03858
  50   -0.2484403    0.1351287

? matrix SU
? matrix SS = ksmooth(null,&SU)
Generated matrix SS
? matrix out2 = SS ~ SU
Generated matrix out2
? out2
out2 (50 x 3)

    -0.38299   1.2812e-05    -0.016642 
    -0.38298   2.5068e-05    -0.012256 
    -0.38295   3.0974e-05   -0.0059053 
    -0.38292  -7.9778e-05      0.11075 
    -0.38300  -0.00014381     0.064035 
    -0.38314  -0.00013087    -0.012945 
    -0.38327  -7.9983e-05    -0.050884 
    -0.38335  -1.0783e-05    -0.069200 
    -0.38337   0.00010779     -0.11857 
    -0.38326  -5.8968e-07      0.10838 
    -0.38326  -5.3318e-05     0.052728 
    -0.38331  -5.3596e-05   0.00027818 
    -0.38337   0.00012285     -0.17645 
    -0.38324   0.00014030    -0.017444 
    -0.38310   0.00022129    -0.080992 
    -0.38288   0.00032083    -0.099537 
    -0.38256   0.00035474    -0.033915 
    -0.38221   0.00027692     0.077824 
    -0.38193   0.00022795     0.048961 
    -0.38170   0.00029902    -0.071070 
    -0.38140   0.00019714      0.10189 
    -0.38120   0.00026986    -0.072722 
    -0.38093   0.00025774     0.012118 
    -0.38068   0.00035781     -0.10007 
    -0.38032   0.00028375     0.074065 
    -0.38004   0.00019287     0.090884 
    -0.37984   0.00033676     -0.14390 
    -0.37951   0.00025421     0.082554 
    -0.37925   0.00014309      0.11112 
    -0.37911   0.00014826   -0.0051712 
    -0.37896   0.00014565    0.0026056 
    -0.37881   0.00016712    -0.021467 
    -0.37865   4.8197e-05      0.11892 
    -0.37860  -4.6404e-05     0.094601 
    -0.37865  -7.7665e-05     0.031261 
    -0.37872  -2.8944e-05    -0.048721 
    -0.37875  -0.00020605      0.17711 
    -0.37896  -9.7612e-05     -0.10844 
    -0.37906  -0.00018984     0.092223 
    -0.37925  -0.00012847    -0.061365 
    -0.37937  -1.2812e-06     -0.12719 
    -0.37938  -0.00010744      0.10616 
    -0.37948   5.6832e-05     -0.16427 
    -0.37943  -1.8350e-05     0.075182 
    -0.37944   5.1534e-05    -0.069884 
    -0.37939   4.0756e-05     0.010778 
    -0.37935   0.00014719     -0.10643 
    -0.37920   8.8827e-05     0.058361 
    -0.37912   0.00013054    -0.041718 
    -0.37899       0.0000      0.13054 

? delete kalman
Deleted kalman filter
Done
