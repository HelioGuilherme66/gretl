gretl version 2021d-git
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2021-09-28 22:40
? run ps8-7.inp
 /usr/local/share/gretl/scripts/ramanathan/ps8-7.inp
# PS8.7, for Example 8.8 -- estimation of model by FGLS
? open data8-1

Read datafile /usr/local/share/gretl/data/ramanathan/data8-1.gdt
periodicity: 1, maxobs: 222
observations range: 1 to 222

Listing 3 variables:
  0) const     1) SALARY    2) YEARS   

? genr LNSALARY=ln(SALARY)
Generated series LNSALARY (ID 3)
# generate powers of YEARS for the various tests
? genr YRS2 = YEARS*YEARS
Generated series YRS2 (ID 4)
? genr YRS3 = YEARS*YRS2
Generated series YRS3 (ID 5)
? genr YRS4 = YRS2*YRS2
Generated series YRS4 (ID 6)
# estimate log quadratic model by OLS
? ols LNSALARY const YEARS YRS2

Model 1: OLS, using observations 1-222
Dependent variable: LNSALARY

             coefficient    std. error    t-ratio    p-value 
  -----------------------------------------------------------
  const       3.80937       0.0413383     92.15     3.79e-177 ***
  YEARS       0.0438528     0.00482873     9.082    6.43e-17  ***
  YRS2       -0.000627348   0.000120861   -5.191    4.77e-07  ***

Mean dependent var   4.325410   S.D. dependent var   0.302511
Sum squared resid    9.380504   S.E. of regression   0.206962
R-squared            0.536179   Adjusted R-squared   0.531943
F(2, 219)            126.5823   P-value(F)           2.92e-37
Log-likelihood       36.20452   Akaike criterion    -66.40903
Schwarz criterion   -56.20100   Hannan-Quinn        -62.28766

# save absolute value of uhat and uhat squared
? genr absuhat=abs($uhat)
Generated series absuhat (ID 7)
? genr usq=$uhat*$uhat
Generated series usq (ID 8)
# compute weights using the Glesjer test approach
? ols absuhat const YEARS YRS2

Model 2: OLS, using observations 1-222
Dependent variable: absuhat

             coefficient    std. error    t-ratio   p-value 
  ----------------------------------------------------------
  const       0.0312025     0.0240727      1.296    0.1963  
  YEARS       0.0143923     0.00281193     5.118    6.74e-07 ***
  YRS2       -0.000297525   7.03814e-05   -4.227    3.47e-05 ***

Mean dependent var   0.160558   S.D. dependent var   0.128647
Sum squared resid    3.181048   S.E. of regression   0.120521
R-squared            0.130283   Adjusted R-squared   0.122340
F(2, 219)            16.40300   P-value(F)           2.30e-07
Log-likelihood       156.2424   Akaike criterion    -306.4849
Schwarz criterion   -296.2768   Hannan-Quinn        -302.3635

# predict uhat as observed minus residual stored as uhat
? genr absuhat1=absuhat-$uhat
Generated series absuhat1 (ID 9)
? print absuhat1

Full data range: 1 - 222 (n = 222)

0.0452972  0.0452972  0.0452972  0.0587969  0.0587969  0.0587969  0.0587969  
0.0587969  0.0587969  0.0587969  0.0717015  0.0717015  0.0717015  0.0717015  
0.0717015  0.0717015  0.0717015  0.0717015  0.0717015  0.0840111  0.0840111  
0.0840111  0.0840111  0.0840111  0.0840111  0.0840111  0.0957256  0.0957256  
0.0957256  0.0957256  0.0957256  0.0957256  0.0957256  0.106845  0.106845  
0.106845  0.106845  0.106845  0.106845  0.117370  0.117370  0.117370  
0.117370  0.117370  0.117370  0.117370  0.117370  0.127299  0.127299  
0.127299  0.127299  0.127299  0.127299  0.127299  0.136633  0.136633  
0.136633  0.136633  0.136633  0.145373  0.145373  0.145373  0.145373  
0.145373  0.145373  0.145373  0.145373  0.145373  0.153517  0.153517  
0.153517  0.153517  0.161066  0.161066  0.161066  0.161066  0.161066  
0.161066  0.161066  0.161066  0.168020  0.168020  0.168020  0.168020  
0.168020  0.168020  0.168020  0.168020  0.174379  0.174379  0.174379  
0.174379  0.174379  0.174379  0.174379  0.174379  0.180143  0.180143  
0.180143  0.180143  0.180143  0.185312  0.185312  0.185312  0.185312  
0.189886  0.189886  0.189886  0.189886  0.193865  0.193865  0.193865  
0.193865  0.193865  0.193865  0.197249  0.197249  0.197249  0.197249  
0.197249  0.197249  0.197249  0.200038  0.200038  0.200038  0.200038  
0.200038  0.202231  0.202231  0.202231  0.202231  0.202231  0.202231  
0.203830  0.203830  0.203830  0.203830  0.203830  0.203830  0.203830  
0.203830  0.204834  0.204834  0.204834  0.204834  0.205242  0.205242  
0.205242  0.205056  0.205056  0.205056  0.205056  0.205056  0.205056  
0.205056  0.205056  0.205056  0.205056  0.204274  0.204274  0.204274  
0.204274  0.204274  0.204274  0.204274  0.204274  0.204274  0.202898  
0.202898  0.202898  0.202898  0.202898  0.202898  0.202898  0.202898  
0.200926  0.200926  0.200926  0.200926  0.200926  0.200926  0.200926  
0.198359  0.198359  0.198359  0.198359  0.198359  0.198359  0.198359  
0.195198  0.195198  0.195198  0.195198  0.195198  0.195198  0.191441  
0.191441  0.191441  0.191441  0.191441  0.187089  0.182142  0.182142  
0.176600  0.176600  0.176600  0.176600  0.176600  0.170463  0.170463  
0.170463  0.163731  0.163731  0.156404  0.156404  0.156404  0.148482  
0.130852  0.130852  0.110843  0.0884531  0.0763656  

# luckily all estimated sigmas are positive and so apply WLS
? genr wt1=1/(absuhat1^2)
Generated series wt1 (ID 10)
? wls wt1 LNSALARY const YEARS YRS2

Model 3: WLS, using observations 1-222
Dependent variable: LNSALARY
Variable used as weight: wt1

             coefficient    std. error    t-ratio    p-value 
  -----------------------------------------------------------
  const       3.84155       0.0186959     205.5     1.86e-252 ***
  YEARS       0.0365552     0.00307914     11.87    2.01e-25  ***
  YRS2       -0.000406817   7.94854e-05    -5.118   6.74e-07  ***

Statistics based on the weighted data:

Sum squared resid    325.1666   S.E. of regression   1.218515
R-squared            0.733765   Adjusted R-squared   0.731333
F(2, 219)            301.7902   P-value(F)           1.17e-63
Log-likelihood      -357.3686   Akaike criterion     720.7373
Schwarz criterion    730.9453   Hannan-Quinn         724.8587

Statistics based on the original data:

Mean dependent var   4.325410   S.D. dependent var   0.302511
Sum squared resid    9.559851   S.E. of regression   0.208931

# compute weights using the Breusch-Pagan test approach
? ols usq const YEARS YRS2

Model 4: OLS, using observations 1-222
Dependent variable: usq

             coefficient    std. error    t-ratio   p-value
  ---------------------------------------------------------
  const      -0.0110860     0.0134726     -0.8229   0.4115 
  YEARS       0.00608369    0.00157374     3.866    0.0001  ***
  YRS2       -0.000128833   3.93899e-05   -3.271    0.0012  ***

Mean dependent var   0.042255   S.D. dependent var   0.069804
Sum squared resid    0.996378   S.E. of regression   0.067451
R-squared            0.074714   Adjusted R-squared   0.066264
F(2, 219)            8.841813   P-value(F)           0.000203
Log-likelihood       285.0957   Akaike criterion    -564.1913
Schwarz criterion   -553.9833   Hannan-Quinn        -560.0699

/* predict uhat squared as observed uhat square minus residual
   stored under the name uhat.  Note that even though labelled as uhat,
   it is really the residuals for uhat squared model */
? genr usqhat1=usq-$uhat
Generated series usqhat1 (ID 11)
# print estimated variance and note that 3 observations have negative
# values, which are unacceptable
? print usqhat1

Full data range: 1 - 222 (n = 222)

-0.00513117  -0.00513117  -0.00513117   0.000566030   0.000566030  
 0.000566030   0.000566030   0.000566030   0.000566030   0.000566030  
 0.00600556   0.00600556   0.00600556   0.00600556   0.00600556   0.00600556  
 0.00600556   0.00600556   0.00600556   0.0111874   0.0111874   0.0111874  
 0.0111874   0.0111874   0.0111874   0.0111874   0.0161116   0.0161116  
 0.0161116   0.0161116   0.0161116   0.0161116   0.0161116   0.0207782  
 0.0207782   0.0207782   0.0207782   0.0207782   0.0207782   0.0251870  
 0.0251870   0.0251870   0.0251870   0.0251870   0.0251870   0.0251870  
 0.0251870   0.0293382   0.0293382   0.0293382   0.0293382   0.0293382  
 0.0293382   0.0293382   0.0332318   0.0332318   0.0332318   0.0332318  
 0.0332318   0.0368677   0.0368677   0.0368677   0.0368677   0.0368677  
 0.0368677   0.0368677   0.0368677   0.0368677   0.0402459   0.0402459  
 0.0402459   0.0402459   0.0433664   0.0433664   0.0433664   0.0433664  
 0.0433664   0.0433664   0.0433664   0.0433664   0.0462293   0.0462293  
 0.0462293   0.0462293   0.0462293   0.0462293   0.0462293   0.0462293  
 0.0488345   0.0488345   0.0488345   0.0488345   0.0488345   0.0488345  
 0.0488345   0.0488345   0.0511821   0.0511821   0.0511821   0.0511821  
 0.0511821   0.0532720   0.0532720   0.0532720   0.0532720   0.0551042  
 0.0551042   0.0551042   0.0551042   0.0566787   0.0566787   0.0566787  
 0.0566787   0.0566787   0.0566787   0.0579956   0.0579956   0.0579956  
 0.0579956   0.0579956   0.0579956   0.0579956   0.0590549   0.0590549  
 0.0590549   0.0590549   0.0590549   0.0598564   0.0598564   0.0598564  
 0.0598564   0.0598564   0.0598564   0.0604003   0.0604003   0.0604003  
 0.0604003   0.0604003   0.0604003   0.0604003   0.0604003   0.0606865  
 0.0606865   0.0606865   0.0606865   0.0607151   0.0607151   0.0607151  
 0.0604860   0.0604860   0.0604860   0.0604860   0.0604860   0.0604860  
 0.0604860   0.0604860   0.0604860   0.0604860   0.0599992   0.0599992  
 0.0599992   0.0599992   0.0599992   0.0599992   0.0599992   0.0599992  
 0.0599992   0.0592548   0.0592548   0.0592548   0.0592548   0.0592548  
 0.0592548   0.0592548   0.0592548   0.0582527   0.0582527   0.0582527  
 0.0582527   0.0582527   0.0582527   0.0582527   0.0569930   0.0569930  
 0.0569930   0.0569930   0.0569930   0.0569930   0.0569930   0.0554755  
 0.0554755   0.0554755   0.0554755   0.0554755   0.0554755   0.0537005  
 0.0537005   0.0537005   0.0537005   0.0537005   0.0516677   0.0493773  
 0.0493773   0.0468292   0.0468292   0.0468292   0.0468292   0.0468292  
 0.0440234   0.0440234   0.0440234   0.0409600   0.0409600   0.0376390  
 0.0376390   0.0376390   0.0340602   0.0261297   0.0261297   0.0171686  
 0.00717679   0.00179439  

# replace these negative values with the original uhat squared values
? genr d1=(usqhat1>0.0)
Generated series d1 (ID 12)
? genr usqhat2=(d1*usqhat1) + ((1-d1)*usq)
Generated series usqhat2 (ID 13)
? print usqhat2

Full data range: 1 - 222 (n = 222)

0.00973239  0.00353218  0.00353218  0.000566030  0.000566030  0.000566030  
0.000566030  0.000566030  0.000566030  0.000566030  0.00600556  0.00600556  
0.00600556  0.00600556  0.00600556  0.00600556  0.00600556  0.00600556  
0.00600556  0.0111874  0.0111874  0.0111874  0.0111874  0.0111874  0.0111874  
0.0111874  0.0161116  0.0161116  0.0161116  0.0161116  0.0161116  0.0161116  
0.0161116  0.0207782  0.0207782  0.0207782  0.0207782  0.0207782  0.0207782  
0.0251870  0.0251870  0.0251870  0.0251870  0.0251870  0.0251870  0.0251870  
0.0251870  0.0293382  0.0293382  0.0293382  0.0293382  0.0293382  0.0293382  
0.0293382  0.0332318  0.0332318  0.0332318  0.0332318  0.0332318  0.0368677  
0.0368677  0.0368677  0.0368677  0.0368677  0.0368677  0.0368677  0.0368677  
0.0368677  0.0402459  0.0402459  0.0402459  0.0402459  0.0433664  0.0433664  
0.0433664  0.0433664  0.0433664  0.0433664  0.0433664  0.0433664  0.0462293  
0.0462293  0.0462293  0.0462293  0.0462293  0.0462293  0.0462293  0.0462293  
0.0488345  0.0488345  0.0488345  0.0488345  0.0488345  0.0488345  0.0488345  
0.0488345  0.0511821  0.0511821  0.0511821  0.0511821  0.0511821  0.0532720  
0.0532720  0.0532720  0.0532720  0.0551042  0.0551042  0.0551042  0.0551042  
0.0566787  0.0566787  0.0566787  0.0566787  0.0566787  0.0566787  0.0579956  
0.0579956  0.0579956  0.0579956  0.0579956  0.0579956  0.0579956  0.0590549  
0.0590549  0.0590549  0.0590549  0.0590549  0.0598564  0.0598564  0.0598564  
0.0598564  0.0598564  0.0598564  0.0604003  0.0604003  0.0604003  0.0604003  
0.0604003  0.0604003  0.0604003  0.0604003  0.0606865  0.0606865  0.0606865  
0.0606865  0.0607151  0.0607151  0.0607151  0.0604860  0.0604860  0.0604860  
0.0604860  0.0604860  0.0604860  0.0604860  0.0604860  0.0604860  0.0604860  
0.0599992  0.0599992  0.0599992  0.0599992  0.0599992  0.0599992  0.0599992  
0.0599992  0.0599992  0.0592548  0.0592548  0.0592548  0.0592548  0.0592548  
0.0592548  0.0592548  0.0592548  0.0582527  0.0582527  0.0582527  0.0582527  
0.0582527  0.0582527  0.0582527  0.0569930  0.0569930  0.0569930  0.0569930  
0.0569930  0.0569930  0.0569930  0.0554755  0.0554755  0.0554755  0.0554755  
0.0554755  0.0554755  0.0537005  0.0537005  0.0537005  0.0537005  0.0537005  
0.0516677  0.0493773  0.0493773  0.0468292  0.0468292  0.0468292  0.0468292  
0.0468292  0.0440234  0.0440234  0.0440234  0.0409600  0.0409600  0.0376390  
0.0376390  0.0376390  0.0340602  0.0261297  0.0261297  0.0171686  0.00717679  
0.00179439  

# compute weights and use FGLS which is also WLS
? genr wt2=1/usqhat2
Generated series wt2 (ID 14)
? wls wt2 LNSALARY const YEARS YRS2

Model 5: WLS, using observations 1-222
Dependent variable: LNSALARY
Variable used as weight: wt2

             coefficient    std. error    t-ratio    p-value 
  -----------------------------------------------------------
  const       3.86919       0.0110480     350.2     5.20e-303 ***
  YEARS       0.0310905     0.00252578     12.31    8.25e-27  ***
  YRS2       -0.000239222   6.21690e-05    -3.848   0.0002    ***

Statistics based on the weighted data:

Sum squared resid    233.8347   S.E. of regression   1.033314
R-squared            0.829608   Adjusted R-squared   0.828052
F(2, 219)            533.1350   P-value(F)           6.98e-85
Log-likelihood      -320.7693   Akaike criterion     647.5387
Schwarz criterion    657.7467   Hannan-Quinn         651.6601

Statistics based on the original data:

Mean dependent var   4.325410   S.D. dependent var   0.302511
Sum squared resid    9.938558   S.E. of regression   0.213029

# compute weights using the White's test approach
? ols usq const YEARS YRS2 YRS3 YRS4

Model 6: OLS, using observations 1-222
Dependent variable: usq

             coefficient    std. error    t-ratio    p-value
  ----------------------------------------------------------
  const      -0.00177015    0.0259525     -0.06821   0.9457 
  YEARS       0.000167112   0.00795976     0.02099   0.9833 
  YRS2        0.000646662   0.000729938    0.8859    0.3766 
  YRS3       -3.26367e-05   2.51701e-05   -1.297     0.1961 
  YRS4        4.22236e-07   2.87764e-07    1.467     0.1437 

Mean dependent var   0.042255   S.D. dependent var   0.069804
Sum squared resid    0.979836   S.E. of regression   0.067197
R-squared            0.090076   Adjusted R-squared   0.073303
F(4, 217)            5.370347   P-value(F)           0.000384
Log-likelihood       286.9539   Akaike criterion    -563.9079
Schwarz criterion   -546.8945   Hannan-Quinn        -557.0389

Excluding the constant, p-value was highest for variable 2 (YEARS)

? genr usqhat3=usq-$uhat
Generated series usqhat3 (ID 15)
# print estimated variance and note that this also has negative
# values, which are unacceptable
? print usqhat3

Full data range: 1 - 222 (n = 222)

-0.000988590  -0.000988590  -0.000988590   0.000896384   0.000896384  
 0.000896384   0.000896384   0.000896384   0.000896384   0.000896384  
 0.00370415   0.00370415   0.00370415   0.00370415   0.00370415   0.00370415  
 0.00370415   0.00370415   0.00370415   0.00726423   0.00726423   0.00726423  
 0.00726423   0.00726423   0.00726423   0.00726423   0.0114163   0.0114163  
 0.0114163   0.0114163   0.0114163   0.0114163   0.0114163   0.0160100  
 0.0160100   0.0160100   0.0160100   0.0160100   0.0160100   0.0209055  
 0.0209055   0.0209055   0.0209055   0.0209055   0.0209055   0.0209055  
 0.0209055   0.0259726   0.0259726   0.0259726   0.0259726   0.0259726  
 0.0259726   0.0259726   0.0310916   0.0310916   0.0310916   0.0310916  
 0.0310916   0.0361528   0.0361528   0.0361528   0.0361528   0.0361528  
 0.0361528   0.0361528   0.0361528   0.0361528   0.0410566   0.0410566  
 0.0410566   0.0410566   0.0457137   0.0457137   0.0457137   0.0457137  
 0.0457137   0.0457137   0.0457137   0.0457137   0.0500448   0.0500448  
 0.0500448   0.0500448   0.0500448   0.0500448   0.0500448   0.0500448  
 0.0539806   0.0539806   0.0539806   0.0539806   0.0539806   0.0539806  
 0.0539806   0.0539806   0.0574622   0.0574622   0.0574622   0.0574622  
 0.0574622   0.0604407   0.0604407   0.0604407   0.0604407   0.0628774  
 0.0628774   0.0628774   0.0628774   0.0647436   0.0647436   0.0647436  
 0.0647436   0.0647436   0.0647436   0.0660209   0.0660209   0.0660209  
 0.0660209   0.0660209   0.0660209   0.0660209   0.0667008   0.0667008  
 0.0667008   0.0667008   0.0667008   0.0667853   0.0667853   0.0667853  
 0.0667853   0.0667853   0.0667853   0.0662862   0.0662862   0.0662862  
 0.0662862   0.0662862   0.0662862   0.0662862   0.0662862   0.0652256  
 0.0652256   0.0652256   0.0652256   0.0636356   0.0636356   0.0636356  
 0.0615585   0.0615585   0.0615585   0.0615585   0.0615585   0.0615585  
 0.0615585   0.0615585   0.0615585   0.0615585   0.0590470   0.0590470  
 0.0590470   0.0590470   0.0590470   0.0590470   0.0590470   0.0590470  
 0.0590470   0.0561634   0.0561634   0.0561634   0.0561634   0.0561634  
 0.0561634   0.0561634   0.0561634   0.0529806   0.0529806   0.0529806  
 0.0529806   0.0529806   0.0529806   0.0529806   0.0495813   0.0495813  
 0.0495813   0.0495813   0.0495813   0.0495813   0.0495813   0.0460587  
 0.0460587   0.0460587   0.0460587   0.0460587   0.0460587   0.0425157  
 0.0425157   0.0425157   0.0425157   0.0425157   0.0390657   0.0358321  
 0.0358321   0.0329484   0.0329484   0.0329484   0.0329484   0.0329484  
 0.0305581   0.0305581   0.0305581   0.0288152   0.0288152   0.0278836  
 0.0278836   0.0278836   0.0279373   0.0317474   0.0317474   0.0418408  
 0.0599748   0.0726505  

# replace these negative values with the original uhat squared values
? genr d2=(usqhat3>0.0)
Generated series d2 (ID 16)
? genr usqhat4=(d2*usqhat3) + ((1-d2)*usq)
Generated series usqhat4 (ID 17)
? print usqhat4

Full data range: 1 - 222 (n = 222)

0.00973239  0.00353218  0.00353218  0.000896384  0.000896384  0.000896384  
0.000896384  0.000896384  0.000896384  0.000896384  0.00370415  0.00370415  
0.00370415  0.00370415  0.00370415  0.00370415  0.00370415  0.00370415  
0.00370415  0.00726423  0.00726423  0.00726423  0.00726423  0.00726423  
0.00726423  0.00726423  0.0114163  0.0114163  0.0114163  0.0114163  
0.0114163  0.0114163  0.0114163  0.0160100  0.0160100  0.0160100  0.0160100  
0.0160100  0.0160100  0.0209055  0.0209055  0.0209055  0.0209055  0.0209055  
0.0209055  0.0209055  0.0209055  0.0259726  0.0259726  0.0259726  0.0259726  
0.0259726  0.0259726  0.0259726  0.0310916  0.0310916  0.0310916  0.0310916  
0.0310916  0.0361528  0.0361528  0.0361528  0.0361528  0.0361528  0.0361528  
0.0361528  0.0361528  0.0361528  0.0410566  0.0410566  0.0410566  0.0410566  
0.0457137  0.0457137  0.0457137  0.0457137  0.0457137  0.0457137  0.0457137  
0.0457137  0.0500448  0.0500448  0.0500448  0.0500448  0.0500448  0.0500448  
0.0500448  0.0500448  0.0539806  0.0539806  0.0539806  0.0539806  0.0539806  
0.0539806  0.0539806  0.0539806  0.0574622  0.0574622  0.0574622  0.0574622  
0.0574622  0.0604407  0.0604407  0.0604407  0.0604407  0.0628774  0.0628774  
0.0628774  0.0628774  0.0647436  0.0647436  0.0647436  0.0647436  0.0647436  
0.0647436  0.0660209  0.0660209  0.0660209  0.0660209  0.0660209  0.0660209  
0.0660209  0.0667008  0.0667008  0.0667008  0.0667008  0.0667008  0.0667853  
0.0667853  0.0667853  0.0667853  0.0667853  0.0667853  0.0662862  0.0662862  
0.0662862  0.0662862  0.0662862  0.0662862  0.0662862  0.0662862  0.0652256  
0.0652256  0.0652256  0.0652256  0.0636356  0.0636356  0.0636356  0.0615585  
0.0615585  0.0615585  0.0615585  0.0615585  0.0615585  0.0615585  0.0615585  
0.0615585  0.0615585  0.0590470  0.0590470  0.0590470  0.0590470  0.0590470  
0.0590470  0.0590470  0.0590470  0.0590470  0.0561634  0.0561634  0.0561634  
0.0561634  0.0561634  0.0561634  0.0561634  0.0561634  0.0529806  0.0529806  
0.0529806  0.0529806  0.0529806  0.0529806  0.0529806  0.0495813  0.0495813  
0.0495813  0.0495813  0.0495813  0.0495813  0.0495813  0.0460587  0.0460587  
0.0460587  0.0460587  0.0460587  0.0460587  0.0425157  0.0425157  0.0425157  
0.0425157  0.0425157  0.0390657  0.0358321  0.0358321  0.0329484  0.0329484  
0.0329484  0.0329484  0.0329484  0.0305581  0.0305581  0.0305581  0.0288152  
0.0288152  0.0278836  0.0278836  0.0278836  0.0279373  0.0317474  0.0317474  
0.0418408  0.0599748  0.0726505  

# compute weights and use FGLS which is also WLS
? genr wt3=1/usqhat4
Generated series wt3 (ID 18)
? wls wt3 LNSALARY const YEARS YRS2

Model 7: WLS, using observations 1-222
Dependent variable: LNSALARY
Variable used as weight: wt3

             coefficient    std. error    t-ratio    p-value 
  -----------------------------------------------------------
  const       3.84763       0.0131252     293.1     3.96e-286 ***
  YEARS       0.0368571     0.00323684     11.39    6.74e-24  ***
  YRS2       -0.000451377   9.48095e-05    -4.761   3.50e-06  ***

Statistics based on the weighted data:

Sum squared resid    218.6830   S.E. of regression   0.999276
R-squared            0.764216   Adjusted R-squared   0.762062
F(2, 219)            354.9072   P-value(F)           1.95e-69
Log-likelihood      -313.3334   Akaike criterion     632.6667
Schwarz criterion    642.8747   Hannan-Quinn         636.7881

Statistics based on the original data:

Mean dependent var   4.325410   S.D. dependent var   0.302511
Sum squared resid    9.499118   S.E. of regression   0.208267

# compute weights using the Harvey-Godfrey test approach
? genr lnusq=ln(usq)
Generated series lnusq (ID 19)
? ols lnusq const YEARS YRS2

Model 8: OLS, using observations 1-222
Dependent variable: lnusq

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  const      -6.56266      0.359239     -18.27    6.50e-46 ***
  YEARS       0.235562     0.0419628      5.614   5.96e-08 ***
  YRS2       -0.00477648   0.00105031    -4.548   8.98e-06 ***

Mean dependent var  -4.404772   S.D. dependent var   1.952342
Sum squared resid    708.4163   S.E. of regression   1.798549
R-squared            0.159023   Adjusted R-squared   0.151342
F(2, 219)            20.70563   P-value(F)           5.81e-09
Log-likelihood      -443.8037   Akaike criterion     893.6074
Schwarz criterion    903.8154   Hannan-Quinn         897.7288

# save estimated ln(sigma square) and take antilog
? genr lnusq1=lnusq-$uhat
Generated series lnusq1 (ID 20)
? genr usqhat5=exp(lnusq1)
Generated series usqhat5 (ID 21)
# compute weights and use FGLS which is also WLS
? genr wt4=1/usqhat5
Generated series wt4 (ID 22)
? wls wt4 LNSALARY const YEARS YRS2

Model 9: WLS, using observations 1-222
Dependent variable: LNSALARY
Variable used as weight: wt4

             coefficient    std. error    t-ratio    p-value 
  -----------------------------------------------------------
  const       3.82751       0.0203046     188.5     2.65e-244 ***
  YEARS       0.0382146     0.00325672     11.73    5.47e-25  ***
  YRS2       -0.000443339   8.27155e-05    -5.360   2.11e-07  ***

Statistics based on the weighted data:

Sum squared resid    618.6209   S.E. of regression   1.680700
R-squared            0.718756   Adjusted R-squared   0.716188
F(2, 219)            279.8417   P-value(F)           4.73e-61
Log-likelihood      -428.7589   Akaike criterion     863.5177
Schwarz criterion    873.7257   Hannan-Quinn         867.6391

Statistics based on the original data:

Mean dependent var   4.325410   S.D. dependent var   0.302511
Sum squared resid    9.533289   S.E. of regression   0.208641

Done
