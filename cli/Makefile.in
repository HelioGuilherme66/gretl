topsrc = ..

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
CC = @CC@
CFLAGS = @CFLAGS@
MAKE = @MAKE@
INSTALL = @INSTALL@
LN = @LN_S@
have_readline = @have_readline@
have_zlib = @have_zlib@
have_gtk = @have_gtk@
CLI_LIBS = @CLI_LIBS@
RL_OBJ = @RL_OBJ@
USE_NLS = @USE_NLS@

ifeq ($(CC),)
  CC = gcc
endif
ifeq ($(INSTALL_PROGRAM),)
  INSTALL_PROGRAM = $(INSTALL) -m 755
endif
ifeq ($(LN),)
  LN = ln -sf
endif
ifeq ($(USE_NLS),yes)
  datadir = @datadir@
  localedir = $(datadir)/locale
  DEFS = -DLOCALEDIR=\"$(localedir)\" -DHAVE_CONFIG_H
endif

GRETLLIB = ../lib/libgretl-1.0.la

# General compile options and libs:
LIBS = $(CLI_LIBS)

# Directories
tooldir = $(topsrc)/tools
libsrc = $(topsrc)/lib/src

#### End of system configuration section. ####

override CFLAGS += -I. -I.. -I$(libsrc) $(DEFS)

CLI = gretlcli
LIBTOOL = $(topsrc)/libtool

$(CLI): gretlcli.o $(RL_OBJ)
	../libtool --mode=link $(CC) -o $@ $< \
	$(RL_OBJ) $(GRETLLIB) $(CLI_LIBS) 

.PHONY :

install: $(CLI) installdirs
	$(LIBTOOL) $(INSTALL_PROGRAM) $(CLI) $(bindir)/$(CLI)

install-strip: $(CLI) installdirs
	$(LIBTOOL) $(INSTALL_PROGRAM) -s $(CLI) $(bindir)/$(CLI)

installdirs: $(tooldir)/mkinstalldirs
	$(tooldir)/mkinstalldirs $(bindir)

clean:
	rm -f *.o $(CLI) core 
	rm -rf ./.libs

depend:
	makedepend -Y../lib/src *.c 

distdepend: depend
	$(tooldir)/dist_depend.pl

# DO NOT DELETE

complete.o: ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
complete.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
complete.o: ../lib/src/gretl_utils.h ../lib/src/compare.h
complete.o: ../lib/src/pvalues.h ../lib/src/dataio.h ../lib/src/strutils.h
complete.o: ../lib/src/describe.h ../lib/src/printout.h
complete.o: ../lib/src/modelprint.h ../lib/src/texprint.h ../lib/src/var.h
complete.o: ../lib/src/interact.h ../lib/src/graphing.h
complete.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
complete.o: ../lib/src/discrete.h ../lib/src/subsample.h
complete.o: ../lib/src/calendar.h ../lib/src/equation_system.h
gretlcli.o: ../lib/src/libgretl.h ../lib/src/commands.h ../lib/src/errors.h
gretlcli.o: ../lib/src/estimate.h ../lib/src/generate.h
gretlcli.o: ../lib/src/gretl_utils.h ../lib/src/compare.h
gretlcli.o: ../lib/src/pvalues.h ../lib/src/dataio.h ../lib/src/strutils.h
gretlcli.o: ../lib/src/describe.h ../lib/src/printout.h
gretlcli.o: ../lib/src/modelprint.h ../lib/src/texprint.h ../lib/src/var.h
gretlcli.o: ../lib/src/interact.h ../lib/src/graphing.h
gretlcli.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
gretlcli.o: ../lib/src/discrete.h ../lib/src/subsample.h
gretlcli.o: ../lib/src/calendar.h ../lib/src/equation_system.h common.c
