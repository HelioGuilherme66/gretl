topsrc = ..

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
CC = @CC@
CFLAGS = @CFLAGS@
MAKE = @MAKE@
INSTALL = @INSTALL@
LN = @LN_S@
have_readline = @have_readline@
have_zlib = @have_zlib@
CLI_LIBS = @CLI_LIBS@
RL_OBJ = @RL_OBJ@

ifeq ($(CC),)
  CC = gcc
endif
ifeq ($(INSTALL_PROGRAM),)
  INSTALL_PROGRAM = $(INSTALL) -m 755
endif
ifeq ($(LN),)
  LN = ln -sf
endif

# General compile options and libs:
LIBS = $(CLI_LIBS)

# Directories
tooldir = $(topsrc)/tools
libsrc = $(topsrc)/lib/src

#### End of system configuration section. ####

CFLAGS += -I. -I$(libsrc)

CLI = gretlcli
LIBTOOL = $(topsrc)/libtool

$(CLI): gretlcli.o $(RL_OBJ)
	../libtool --mode=link $(CC) -o $@ $< \
	$(RL_OBJ) ../lib/libgretl.la $(CLI_LIBS) 

.PHONY :

install: $(CLI) installdirs
	$(LIBTOOL) $(INSTALL_PROGRAM) $(CLI) $(bindir)/$(CLI)

install-strip: $(CLI) installdirs
	$(LIBTOOL) $(INSTALL_PROGRAM) -s $(CLI) $(bindir)/$(CLI)

installdirs: $(tooldir)/mkinstalldirs
	$(tooldir)/mkinstalldirs $(bindir)

clean:
	rm -f *.o $(CLI) core 
	rm -rf ./.libs

depend:
	makedepend -Y../lib/src *.c 

distdepend: depend
	($tooldir)/dist_depend.pl

# DO NOT DELETE

complete.o: ../lib/src/libgretl.h ../lib/src/commands.h ../lib/src/errors.h
complete.o: ../lib/src/estimate.h ../lib/src/generate.h ../lib/src/utils.h
complete.o: ../lib/src/compare.h ../lib/src/pvalues.h ../lib/src/dataio.h
complete.o: ../lib/src/strutils.h ../lib/src/describe.h ../lib/src/printout.h
complete.o: ../lib/src/texprint.h ../lib/src/var.h ../lib/src/interact.h
complete.o: ../lib/src/graphing.h ../lib/src/monte_carlo.h
complete.o: ../lib/src/nonparam.h ../lib/src/discrete.h
complete.o: ../lib/src/subsample.h ../config.h
gretlcli.o: ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
gretlcli.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
gretlcli.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
gretlcli.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
gretlcli.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
gretlcli.o: ../lib/src/interact.h ../lib/src/graphing.h
gretlcli.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
gretlcli.o: ../lib/src/discrete.h ../lib/src/subsample.h common.c
