topsrc = ..

prefix = @prefix@
exec_prefix = @exec_prefix@
CC = @CC@
CFLAGS = @CFLAGS@
MAKE = @MAKE@
INSTALL = @INSTALL@
LN = @LN_S@

ifeq ($(CC),)
  CC = gcc
endif
ifeq ($(INSTALL_PROGRAM),)
  INSTALL_PROGRAM = $(INSTALL) -m 755
endif

# Installation directory
share = $(prefix)/share/gretl

libsrc = $(topsrc)/lib/src

PLUGINS = stats_tables.so panel_data.so

CFLAGS += `gtk-config --cflags` -I$(libsrc) -fPIC -DPIC
LIBTOOL = $(topsrc)/libtool

all: ../lib/libgretl.la $(PLUGINS)

../lib/libgretl.la:
	$(MAKE) -C ../lib

%.so : %.o
	$(LIBTOOL) --mode=link $(CC) -shared -o $@ \
	$< ../lib/libgretl.la `gtk-config --libs`

.PHONY: 

install: $(PLUGINS) installdirs
	$(LIBTOOL) --mode=install $(INSTALL_PROGRAM) \
	$(PLUGINS) $(share)/plugins

install-strip: $(PLUGINS) installdirs
	$(LIBTOOL) --mode=install $(INSTALL_PROGRAM) -s \
	$(PLUGINS) $(share)/plugins

installdirs:
	$(topsrc)/tools/mkinstalldirs $(share)/plugins

clean:
	rm -f *.o $(PLUGINS) core 
	rm -rf .libs

depend:
	makedepend -Y$(libsrc) *.c 

# DO NOT DELETE



