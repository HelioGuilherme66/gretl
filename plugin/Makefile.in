top_builddir = ..

prefix = @prefix@
CC = @CC@
CFLAGS = @CFLAGS@
MAKE = @MAKE@
INSTALL = @INSTALL@
LN = @LN_S@

ifeq ($(prefix),)
  prefix = /opt/esl
endif
ifeq ($(CC),)
  CC = gcc
endif
ifeq ($(CFLAGS),)
  CFLAGS = -g -O2 -Wall
endif
ifeq ($(MAKE),)
  MAKE = make
endif
ifeq ($(INSTALL),)
  INSTALL = /bin/install -c
endif
ifeq ($(INSTALL_PROGRAM),)
  INSTALL_PROGRAM = $(INSTALL) -m 755
endif

# Directories
srcdir  = ./src
VPATH = ./src
share = $(prefix)/share/gretl

GTK_CFLAGS = `gtk-config --cflags`

# General compile options and libs:
PLUGINS  = stats_tables.so panel_data.so

#### End of system configuration section. ####

COMPILE = $(CC) -c $(CFLAGS) $(GTK_CFLAGS) -I../lib/src -fPIC -DPIC

all: $(PLUGINS)

.c.o:        
	$(COMPILE) $< 

stats_tables.so: stats_tables.o
	../libtool --mode=link $(CC) -shared -o stats_tables.so \
	stats_tables.o ../lib/libgretl.la `gtk-config --libs`

panel_data.so: panel_data.o
	../libtool --mode=link $(CC) -shared -o panel_data.so \
	panel_data.o ../lib/libgretl.la `gtk-config --libs`

.PHONY: 

install: $(PLUGINS) installdirs
	../libtool --mode=install $(INSTALL_PROGRAM) \
	$(PLUGINS) $(share)/plugins

install-strip: $(PLUGINS) installdirs
	../libtool --mode=install $(INSTALL_PROGRAM) -s \
	$(PLUGINS) $(share)/plugins

installdirs:
	../tools/mkinstalldirs $(share)/plugins

clean:
	rm -f *.o $(PLUGINS) core 
	rm -rf .libs





