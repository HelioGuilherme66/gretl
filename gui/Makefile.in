top_builddir = ..

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
CC = @CC@
CFLAGS = @CFLAGS@
MAKE = @MAKE@
INSTALL = @INSTALL@
LN = @LN_S@
have_readline = @have_readline@
have_zlib = @have_zlib@
need_libbind = @need_libbind@
have_gtk = @have_gtk@
have_gtkextra = @have_gtkextra@
have_gnome = @have_gnome@
gnome_install_prefix = @gnome_install_prefix@

ifeq ($(prefix),)
  prefix = /opt/esl
endif
ifeq ($(CC),)
  CC = gcc
endif
ifeq ($(CFLAGS),)
  CFLAGS = -g -O2 -Wall
endif
ifeq ($(MAKE),)
  MAKE = make
endif
ifeq ($(INSTALL),)
  INSTALL = /bin/install -c
endif
ifeq ($(INSTALL_PROGRAM),)
  INSTALL_PROGRAM = $(INSTALL) -m 755
endif
ifeq ($(INSTALL_DATA),)
  INSTALL_DATA = $(INSTALL) -m 644
endif
ifeq ($(LN),)
  LN = ln -sf
endif
ifeq ($(need_libbind),yes)
  INETLIB = -lbind
endif
ifeq ($(have_gnome),)
  have_gnome = yes
endif
ifeq ($(gnome_install_prefix),auto)
  gnome_prefix = `gnome-config --prefix`
else
  gnome_prefix = $(gnome_install_prefix)
endif
ifeq ($(have_gnome),yes)
  LIBS = `gnome-config --libs gnomeui` `gtkextra-config --libs` ../lib/libgretl.la 
  GUI_CFLAGS = `gnome-config --cflags gnomeui` `gtkextra-config --cflags`
  desktopdir = $(gnome_prefix)/share/gnome/apps/Applications
  gpixmaps = $(gnome_prefix)/share/pixmaps
  ghelpdir = $(gnome_prefix)/share/gnome/help/gretl
  query_install_gnome = install-gnome
else
  LIBS = `gtk-config --libs` `gtkextra-config --libs` ../lib/libgretl.la
  GUI_CFLAGS = `gtk-config --cflags` `gtkextra-config --cflags`
endif

# Directories
srcdir  = .
bindir	= $(prefix)/bin
gretldir = $(prefix)/share/gretl
tooldir = ../tools

#### End of system configuration section. ####

SHELL = /bin/sh
PROG  = gretl_x11

SRCS = gretl.c lib.c gui_utils.c callbacks.c dialogs.c ssheet.c \
	datafiles.c database.c fileselect.c gpt_control.c session.c \
	webget.c calculator.c htmlprint.c guiprint.c boxplots.c \
	../cli/common.c plotps.c
HDRS = gretl.h lib.h gui_utils.h callbacks.h dialogs.h session.h \
	gretltypes.h webget.h htmlprint.h guiprint.h
OBJS = gui_utils.o lib.o gretl.o callbacks.o dialogs.o ssheet.o \
	datafiles.o database.o fileselect.o gpt_control.o session.o \
	webget.o calculator.o htmlprint.o guiprint.o boxplots.o
COMPILE = $(CC) -c -I$(srcdir) $(CFLAGS) $(GUI_CFLAGS)

.c.o:
	$(COMPILE) $<

$(PROG): $(OBJS) ../Makefile 
	../libtool --mode=link $(CC) -o $(PROG) $(OBJS) \
	$(LIBS) $(INETLIB)

.PHONY:

install: $(PROG) installdirs $(query_install_gnome)
	../libtool $(INSTALL_PROGRAM) $(PROG) $(bindir)/$(PROG)
	$(INSTALL_PROGRAM) ../gretl_sh $(bindir)/gretl
	$(INSTALL_DATA) gretl-logo.xpm $(gretldir)
	$(INSTALL_DATA) ../COPYING $(gretldir)

install-strip: $(PROG) installdirs $(query_install_gnome)
	../libtool $(INSTALL_PROGRAM) -s $(PROG) $(bindir)/$(PROG)
	$(INSTALL_PROGRAM) ../gretl_sh $(bindir)/gretl
	$(INSTALL_DATA) gretl-logo.xpm $(gretldir)
	$(INSTALL_DATA) ../COPYING $(gretldir)

install-gnome: $(PROG) installdirs
	$(tooldir)/mkinstalldirs $(gpixmaps)
	$(INSTALL_DATA) gnome/gretl-gnome-logo.xpm $(gpixmaps)
	$(INSTALL_DATA) gnome/gretl.png $(gpixmaps)
	$(tooldir)/mkinstalldirs $(desktopdir)
	$(INSTALL_DATA) gnome/gretl.desktop $(desktopdir)
	$(tooldir)/mkinstalldirs $(ghelpdir)
	$(tooldir)/mkinstalldirs $(ghelpdir)/C
	$(tooldir)/mkinstalldirs $(ghelpdir)/C/figures
	$(INSTALL_DATA) gnome/topic.dat $(ghelpdir)/C
	$(INSTALL_DATA) ../doc/manual/*.html $(ghelpdir)/C
	$(INSTALL_DATA) ../doc/manual/*.css $(ghelpdir)/C
	$(INSTALL_DATA) ../doc/figures/*.png $(ghelpdir)/C/figures

installdirs:
	$(tooldir)/mkinstalldirs $(bindir) 
	$(tooldir)/mkinstalldirs $(gretldir)

clean:
	rm -f *.o $(PROG) core
	rm -rf .libs

depend:
	makedepend -Y../lib/src *.c 

topclean: 
	rm -f *.o $(PROG) core
	rm -rf .libs

# DO NOT DELETE

boxplots.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
boxplots.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
boxplots.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
boxplots.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
boxplots.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
boxplots.o: ../lib/src/interact.h ../lib/src/graphing.h
boxplots.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
boxplots.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
boxplots.o: gui_utils.h callbacks.h dialogs.h lib.h session.h plotps.c
calculator.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
calculator.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
calculator.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
calculator.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
calculator.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
calculator.o: ../lib/src/interact.h ../lib/src/graphing.h
calculator.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
calculator.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
calculator.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
callbacks.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
callbacks.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
callbacks.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
callbacks.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
callbacks.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
callbacks.o: ../lib/src/interact.h ../lib/src/graphing.h
callbacks.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
callbacks.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
callbacks.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
database.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
database.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
database.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
database.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
database.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
database.o: ../lib/src/interact.h ../lib/src/graphing.h
database.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
database.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
database.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
datafiles.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
datafiles.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
datafiles.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
datafiles.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
datafiles.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
datafiles.o: ../lib/src/interact.h ../lib/src/graphing.h
datafiles.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
datafiles.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
datafiles.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
dialogs.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
dialogs.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
dialogs.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
dialogs.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
dialogs.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
dialogs.o: ../lib/src/interact.h ../lib/src/graphing.h
dialogs.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
dialogs.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
dialogs.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
fileselect.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
fileselect.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
fileselect.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
fileselect.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
fileselect.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
fileselect.o: ../lib/src/interact.h ../lib/src/graphing.h
fileselect.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
fileselect.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
fileselect.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
gpt_control.o: gretl.h ../config.h ../lib/src/libgretl.h
gpt_control.o: ../lib/src/commands.h ../lib/src/errors.h
gpt_control.o: ../lib/src/estimate.h ../lib/src/generate.h ../lib/src/utils.h
gpt_control.o: ../lib/src/compare.h ../lib/src/pvalues.h ../lib/src/dataio.h
gpt_control.o: ../lib/src/strutils.h ../lib/src/describe.h
gpt_control.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
gpt_control.o: ../lib/src/interact.h ../lib/src/graphing.h
gpt_control.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
gpt_control.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
gpt_control.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
gretl.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
gretl.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
gretl.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
gretl.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
gretl.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
gretl.o: ../lib/src/interact.h ../lib/src/graphing.h ../lib/src/monte_carlo.h
gretl.o: ../lib/src/nonparam.h ../lib/src/discrete.h ../lib/src/subsample.h
gretl.o: gretltypes.h gui_utils.h callbacks.h dialogs.h lib.h session.h
gretl.o: pixmaps/gretl.xpm pixmaps/mini.calc.xpm pixmaps/mini.edit.xpm
gretl.o: pixmaps/mini.sh.xpm pixmaps/mini.session.xpm pixmaps/mini.manual.xpm
gretl.o: pixmaps/mini.netscape.xpm pixmaps/mini.pdf.xpm pixmaps/mini.plot.xpm
gretl.o: pixmaps/mini.ofolder.xpm
gui_utils.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
gui_utils.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
gui_utils.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
gui_utils.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
gui_utils.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
gui_utils.o: ../lib/src/interact.h ../lib/src/graphing.h
gui_utils.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
gui_utils.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
gui_utils.o: gui_utils.h callbacks.h dialogs.h lib.h session.h htmlprint.h
gui_utils.o: guiprint.h
guiprint.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
guiprint.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
guiprint.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
guiprint.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
guiprint.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
guiprint.o: ../lib/src/interact.h ../lib/src/graphing.h
guiprint.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
guiprint.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
guiprint.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
htmlprint.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
htmlprint.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
htmlprint.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
htmlprint.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
htmlprint.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
htmlprint.o: ../lib/src/interact.h ../lib/src/graphing.h
htmlprint.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
htmlprint.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
htmlprint.o: gui_utils.h callbacks.h dialogs.h lib.h session.h htmlprint.h
lib.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
lib.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
lib.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
lib.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
lib.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
lib.o: ../lib/src/interact.h ../lib/src/graphing.h ../lib/src/monte_carlo.h
lib.o: ../lib/src/nonparam.h ../lib/src/discrete.h ../lib/src/subsample.h
lib.o: gretltypes.h gui_utils.h callbacks.h dialogs.h lib.h session.h
lib.o: htmlprint.h ../cli/common.c
session.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
session.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
session.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
session.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
session.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
session.o: ../lib/src/interact.h ../lib/src/graphing.h
session.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
session.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
session.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
session.o: pixmaps/model.xpm pixmaps/boxplot.xpm pixmaps/gnuplot.xpm
session.o: pixmaps/xfm_sc.xpm pixmaps/xfm_info.xpm pixmaps/xfm_text.xpm
session.o: pixmaps/rhohat.xpm pixmaps/summary.xpm
ssheet.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
ssheet.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
ssheet.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
ssheet.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
ssheet.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
ssheet.o: ../lib/src/interact.h ../lib/src/graphing.h
ssheet.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
ssheet.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
ssheet.o: gui_utils.h callbacks.h dialogs.h lib.h session.h
webget.o: gretl.h ../config.h ../lib/src/libgretl.h ../lib/src/commands.h
webget.o: ../lib/src/errors.h ../lib/src/estimate.h ../lib/src/generate.h
webget.o: ../lib/src/utils.h ../lib/src/compare.h ../lib/src/pvalues.h
webget.o: ../lib/src/dataio.h ../lib/src/strutils.h ../lib/src/describe.h
webget.o: ../lib/src/printout.h ../lib/src/texprint.h ../lib/src/var.h
webget.o: ../lib/src/interact.h ../lib/src/graphing.h
webget.o: ../lib/src/monte_carlo.h ../lib/src/nonparam.h
webget.o: ../lib/src/discrete.h ../lib/src/subsample.h gretltypes.h
webget.o: gui_utils.h callbacks.h dialogs.h lib.h session.h webget.h
