string DBF = "states.dbf"
string SHP = "states.shp"

open @DBF -q -p
join statepop.gdt population --ikey=STATE_FIPS --okey=FIPS

# cut out Hawaii and Alaska?
series mask = STATE_ABBR == "AK" || STATE_ABBR == "HI"
print -o STATE_NAME population mask

bundle options = null
options.plotfile = "us_states_shp.plt"
options.mask = {mask}
options.height = 500
options.show = 1

outlines_only = 1

if outlines_only
   geoplot(SHP, null, options)
else
   # show population levels in shades of blue
   options.setpal = "blues"
   options.title = "US states, population (lower 48)"
   options.notics = 1
   geoplot(SHP, population, options)
endif

