string JSON = "us-states.geojson"

open @JSON -q -p

join statepop.gdt population --ikey=postal --okey=Code
print -o name postal population

# cut out Hawaii and Alaska
series mask = 0
smpl postal=="HI" || postal=="AK" --restrict
population = NA
mask = NA
smpl full

bundle options = null
options.plotfile = "us_states_json.plt"
options.height = 500

outlines_only = 1

if outlines_only
   # cut out Hawaii and Alaska via mask
   set skip_missing off
   options.mask = {mask}
   geoplot(JSON, null, options)
else
   # show population levels in shades of blue
   options.setpal = "blues"
   options.title = "US states, population (lower 48)"
   geoplot(JSON, population, options)
endif
